{"version":3,"sources":["../../../widgets/Consulta_wgt/Widget.js"],"names":["declare","BaseWidget","lang","LayerInfos","Query","QueryTask","StatisticDefinition","SimpleFillSymbol","SimpleLineSymbol","Color","Graphic","baseClass","iniClause","field_dc_tipo_persona","layersMap","field_dep_nm_depa","field_dep_cd_depa","field_prov_nm_prov","field_prov_cd_prov","field_dist_nm_dist","field_dist_cd_dist","field_codigou_dm","controller_query","controller_ubigeo","temporal_class_results","postCreate","self_cw","inherited","arguments","_getAllLayers","_layerInfosObjClone","getInstance","map","itemInfo","then","hitch","layerInfosObj","_getDataByTipoPersona","id","config","layer_id_dc","feature_dc","getLayerInfoById","queryTask","getUrl","query","where","returnGeometry","returnDistinctValues","outFields","execute","results","result_options","features","i","attributes","forEach","opt","document","createElement","value","element","text","select_tipo_persona_cw","add","selected","_getDataByDepartamento","layer_id_dep","feature_dep","orderByFields","departamento_cw","_getDataByProvincia","evt","cd_depa","target","distrito_cw","innerHTML","container_distrito_cw","classList","remove","layer_id_prov","container_provincia_cw","feature_prov","provincia_cw","contains","toggle","_zoomExtendSelected","_getDataByDistrito","cd_prov","substring","layer_id_dist","feature_dist","_getDistritoSelected","cd_dist","whereDefinition","_addEventToLayerQuery","dojo","on","_setFormContainer","title","currentTarget","innerText","titulo_consulta","ListaCapasConsulta","hidden","nodeContainer_cw","toggleClass","node","dataset","dojoAttachPoint","includes","_returnListaCapasConsulta","_addEventToTabsOptions","_connectTabsWithOptionContainer","option","toLowerCase","container_option","_validateRucNumber","val","replace","_openPopupAutocamitcally","featureInfo","center","layerObject","queryFeatures","infoWindow","setFeatures","show","getInfoWindowAnchor","centerAt","_zoomDmExtentToMap","id_layer","layer_id_dm","feature","getLayerObject","response","graphics","clear","console","log","length","symbol","STYLE_NULL","STYLE_SOLID","ext","geometry","getExtent","graphic","setSymbol","setExtent","ap_alerta_resultados_cw","error","alert","idService","queryExtent","res","count","extent","_applyQuery","ap_registros_encontrados_cw","_applyQueryDC","_applyQueryDM","_populateResultsDC","arrayResults","r","newRow","clone","ap_template_registros_resultados_cw","style","display","nodeTitle","getElementsByClassName","connect","_showPopupRowSelectedClick","fieldsList","push","fieldsListNode","join","appendChild","_showReinfos","parentElement","getAttribute","elm","removeChild","feature_sys","layer_id_dc_sys","setFilter","rownum","data","lidata","index","lidataString","ulnode","create","addClass","_populateResultsDM","_showPopupRowSelectedClickDM","id_row","id_layer_sys","_openPopupAutocamitcally2","featureLayer","getCentroid","whereDefinitionArray","input_ruc_dc_cw","ruc_dc","nombre_dc","input_nombre_dc_cw","tipo_persona_dc","codigou_dc","input_codigou_dc_cw","nombredm_dc","input_nombre_dm_dc_cw","ubigeo_dc","id_sys","result","rowcount","ap_indicador_resultados_cw","ap_titulo_resultados_cw","ap_none_resultados_opcion_cw","class_list_container_resultados","container_resultados_opcion_cw","ap_resultados_cw","click","codigou_dm","input_codigou_dm_cw","nombredm_dm","input_nombre_dm_cw","startup","onOpen"],"mappings":"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","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\n// import query from \"dojo/query\";\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport StatisticDefinition from \"esri/tasks/StatisticDefinition\";\r\n// import InfoTemplate from \"esri/InfoTemplate\";\r\n// import FeatureLayer from \"esri/layers/FeatureLayer\";\r\nimport SimpleFillSymbol from \"esri/symbols/SimpleFillSymbol\";\r\nimport SimpleLineSymbol from \"esri/symbols/SimpleLineSymbol\";\r\nimport Color from \"esri/Color\";\r\nimport Graphic from \"esri/graphic\";\r\n// import domConstruct from 'dojo/dom-construct';\r\n// import on from 'dojo/on';\r\n// import domClass from \"dojo/dom-class\";\r\n// import \"dojo/domReady!\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([BaseWidget, Query,\r\n    QueryTask,\r\n    StatisticDefinition,\r\n    // FeatureLayer\r\n], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'consulta-wgt',\r\n    iniClause: '1=1',\r\n    field_dc_tipo_persona: 'TIPO_PERSONA',\r\n    layersMap: [],\r\n\r\n    field_dep_nm_depa: 'NM_DEPA',\r\n    field_dep_cd_depa: 'CD_DEPA',\r\n\r\n    field_prov_nm_prov: 'NM_PROV',\r\n    field_prov_cd_prov: 'CD_PROV',\r\n\r\n    field_dist_nm_dist: 'NM_DIST',\r\n    field_dist_cd_dist: 'CD_DIST',\r\n\r\n    field_codigou_dm: 'CODIGOU',\r\n\r\n    controller_query: '', // Permite identificar la opcion de consulta seleccionada\r\n\r\n    controller_ubigeo: '',\r\n\r\n    temporal_class_results: '',\r\n\r\n    // add additional properties here\r\n\r\n    // methods to communication with app container:\r\n    postCreate() {\r\n        self_cw = this;\r\n        this.inherited(arguments);\r\n        // console.log('Consulta_wgt::postCreate');;\r\n        this._getAllLayers();\r\n    },\r\n\r\n    _getAllLayers() {\r\n        _layerInfosObjClone = []\r\n        LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n            .then(lang.hitch(this, function(layerInfosObj) {\r\n                this.layersMap = layerInfosObj;\r\n            }));\r\n    },\r\n    // Metodos para agregar opciones a las etiquetas 'select'\r\n\r\n    _getDataByTipoPersona() {\r\n        var id = self_cw.config.layer_id_dc\r\n        var feature_dc = this.layersMap.getLayerInfoById(id);\r\n        var queryTask = new QueryTask(feature_dc.getUrl());\r\n        var query = new Query();\r\n        query.where = `${self_cw.field_dc_tipo_persona} IS NOT NULL`;\r\n        query.returnGeometry = false;\r\n        query.returnDistinctValues = true;\r\n        query.outFields = [self_cw.field_dc_tipo_persona];\r\n        queryTask.execute(query, function(results) {\r\n            var result_options = results.features.map((i) => i.attributes[self_cw.field_dc_tipo_persona]);\r\n            result_options.forEach(element => {\r\n                opt = document.createElement(\"option\");\r\n                opt.value = element;\r\n                opt.text = element;\r\n                self_cw.select_tipo_persona_cw.add(opt);\r\n            })\r\n            opt = document.createElement(\"option\");\r\n            opt.value = '';\r\n            opt.text = 'Todos';\r\n            opt.selected = true;\r\n            self_cw.select_tipo_persona_cw.add(opt);\r\n        });\r\n    },\r\n\r\n    _getDataByDepartamento() {\r\n        var id = self_cw.config.layer_id_dep\r\n        var feature_dep = this.layersMap.getLayerInfoById(id);\r\n        var queryTask = new QueryTask(feature_dep.getUrl());\r\n        var query = new Query();\r\n        query.where = `${self_cw.field_dep_cd_depa} <> 99`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [self_cw.field_dep_nm_depa, self_cw.field_dep_cd_depa];\r\n        query.orderByFields = [self_cw.field_dep_nm_depa];\r\n        queryTask.execute(query, function(results) {\r\n            var result_options = results.features.map((i) => i.attributes);\r\n            result_options.forEach(element => {\r\n                opt = document.createElement(\"option\");\r\n                opt.value = element[self_cw.field_dep_cd_depa];\r\n                opt.text = element[self_cw.field_dep_nm_depa];\r\n                self_cw.departamento_cw.add(opt);\r\n            })\r\n            opt = document.createElement(\"option\");\r\n            opt.value = '';\r\n            opt.text = 'Todos';\r\n            opt.selected = true;\r\n            self_cw.departamento_cw.add(opt);\r\n        })\r\n    },\r\n\r\n    _getDataByProvincia(evt) {\r\n        var cd_depa = evt.target.value;\r\n        self_cw.controller_ubigeo = cd_depa;\r\n\r\n        self_cw.distrito_cw.innerHTML = '';\r\n        self_cw.container_distrito_cw.classList.remove('active');\r\n\r\n        var id = self_cw.config.layer_id_prov\r\n        if (cd_depa == '') {\r\n            // self_cw.config.layer_id_prov = ''\r\n            self_cw.container_provincia_cw.classList.remove('active');\r\n            // self_cw.container_distrito_cw.classList.remove('active');\r\n            return\r\n        }\r\n\r\n        var feature_prov = this.layersMap.getLayerInfoById(id);\r\n        var queryTask = new QueryTask(feature_prov.getUrl());\r\n        var query = new Query();\r\n        query.where = `${self_cw.field_dep_cd_depa} = '${cd_depa}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [self_cw.field_prov_nm_prov, self_cw.field_prov_cd_prov];\r\n        query.orderByFields = [self_cw.field_prov_nm_prov];\r\n        queryTask.execute(query, function(results) {\r\n            self_cw.provincia_cw.innerHTML = \"\";\r\n            // self_cw.distrito_cw.innerHTML = '';\r\n            var result_options = results.features.map((i) => i.attributes);\r\n            result_options.forEach(element => {\r\n                opt = document.createElement(\"option\");\r\n                opt.value = element[self_cw.field_prov_cd_prov];\r\n                opt.text = element[self_cw.field_prov_nm_prov];\r\n                self_cw.provincia_cw.add(opt);\r\n            })\r\n            opt = document.createElement(\"option\");\r\n            opt.value = '';\r\n            opt.text = 'Todos';\r\n            opt.selected = true;\r\n            self_cw.provincia_cw.add(opt);\r\n\r\n        });\r\n        if (!self_cw.container_provincia_cw.classList.contains('active')) {\r\n            self_cw.container_provincia_cw.classList.toggle('active');\r\n        };\r\n\r\n        self_cw._zoomExtendSelected(self_cw.config.layer_id_dep, query.where);\r\n    },\r\n\r\n    _getDataByDistrito(evt) {\r\n        var cd_prov = evt.target.value;\r\n        if (cd_prov == '') {\r\n            self_cw.controller_ubigeo = self_cw.controller_ubigeo.substring(0, 2)\r\n            self_cw.container_distrito_cw.classList.remove('active')\r\n            return\r\n        }\r\n        self_cw.controller_ubigeo = cd_prov;\r\n        var id = self_cw.config.layer_id_dist\r\n        var feature_dist = this.layersMap.getLayerInfoById(id);\r\n        var queryTask = new QueryTask(feature_dist.getUrl());\r\n        var query = new Query();\r\n        query.where = `${self_cw.field_prov_cd_prov} = '${cd_prov}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [self_cw.field_dist_nm_dist, self_cw.field_dist_cd_dist];\r\n        query.orderByFields = [self_cw.field_dist_nm_dist];\r\n        queryTask.execute(query, function(results) {\r\n            self_cw.distrito_cw.innerHTML = \"\";\r\n            var result_options = results.features.map((i) => i.attributes);\r\n            result_options.forEach(element => {\r\n                opt = document.createElement(\"option\");\r\n                opt.value = element[self_cw.field_dist_cd_dist];\r\n                opt.text = element[self_cw.field_dist_nm_dist];\r\n                self_cw.distrito_cw.add(opt);\r\n            })\r\n            opt = document.createElement(\"option\");\r\n            opt.value = '';\r\n            opt.text = 'Todos';\r\n            opt.selected = true;\r\n            self_cw.distrito_cw.add(opt);\r\n        });\r\n        if (!self_cw.container_distrito_cw.classList.contains('active')) {\r\n            self_cw.container_distrito_cw.classList.toggle('active');\r\n        }\r\n\r\n        self_cw._zoomExtendSelected(self_cw.config.layer_id_prov, query.where);\r\n    },\r\n\r\n    _getDistritoSelected(evt) {\r\n        var cd_dist = evt.target.value;\r\n        whereDefinition = `${self_cw.field_dist_cd_dist} = '${cd_dist}'`\r\n        if (cd_dist == '') {\r\n            self_cw.controller_ubigeo = self_cw.controller_ubigeo.substring(0, 4)\r\n            return\r\n        }\r\n        self_cw.controller_ubigeo = cd_dist;\r\n        self_cw._zoomExtendSelected(self_cw.config.layer_id_dist, whereDefinition);\r\n    },\r\n\r\n    // Metodos dedicados al frontend del widget\r\n\r\n    _addEventToLayerQuery() {\r\n        dojo.query(\".capa_consulta_cw\").on('click', self_cw._setFormContainer);\r\n    },\r\n\r\n    _setFormContainer(evt) {\r\n        var title = evt.currentTarget.innerText;\r\n        // var id = evt.currentTarget.id;\r\n        self_cw.controller_query = evt.currentTarget.id;\r\n        self_cw.titulo_consulta.innerText = title\r\n        self_cw.ListaCapasConsulta.hidden = true;\r\n\r\n        var nodeContainer_cw = dojo.query(\".container_cw\")\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active')\r\n        dojo.query('.formulario_cw').forEach(function(node) {\r\n            if (node.dataset.dojoAttachPoint.includes(self_cw.controller_query)) {\r\n                node.hidden = false;\r\n            } else {\r\n                node.hidden = true;\r\n            }\r\n        })\r\n    },\r\n\r\n    _returnListaCapasConsulta() {\r\n        var nodeContainer_cw = dojo.query(\".container_cw\");\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active');\r\n        self_cw.ListaCapasConsulta.hidden = false;\r\n    },\r\n\r\n    _addEventToTabsOptions() {\r\n        dojo.query('.opcion_cw').on('click', self_cw._connectTabsWithOptionContainer)\r\n    },\r\n\r\n    _connectTabsWithOptionContainer(evt) {\r\n        var option = evt.currentTarget.innerText.toLowerCase();\r\n        if (evt.currentTarget.classList.contains('is-active')) {\r\n            return\r\n        };\r\n        dojo.query('.opcion_cw').forEach(function(node) {\r\n            var container_option = self_cw[`${node.id}_${node.classList[0]}`]\r\n            if (node.innerText.toLowerCase() == option) {\r\n                node.classList.toggle('is-active')\r\n                container_option.classList.toggle('active')\r\n            } else {\r\n                node.classList.remove('is-active');\r\n                container_option.classList.remove('active')\r\n            }\r\n        });\r\n    },\r\n\r\n    _validateRucNumber(evt) {\r\n        var val = evt.currentTarget.value;\r\n        evt.currentTarget.value = val.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');\r\n    },\r\n\r\n    // Interaccion con el mapa\r\n\r\n    _openPopupAutocamitcally(featureInfo, center, whereDefinition) {\r\n        var query = new Query();\r\n        query.where = whereDefinition;\r\n        featureInfo.layerObject.queryFeatures(query, function(results) {\r\n            self_cw.map.infoWindow.setFeatures(results.features);\r\n            self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n            self_cw.map.centerAt(center);\r\n\r\n            // self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        });\r\n\r\n    },\r\n\r\n    _zoomDmExtentToMap(evt) {\r\n\r\n        // self_cw._applyQueryDM.click()\r\n        let id = evt.currentTarget.innerText;\r\n        query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${evt.currentTarget.innerText}'`\r\n        var id_layer = self_cw.config.layer_id_dm;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            self_cw.map.graphics.clear();\r\n            response.queryFeatures(query, function(results) {\r\n                console.log(results.features);\r\n                if (results.features.length) {\r\n                    let symbol = new SimpleFillSymbol(\r\n                        SimpleFillSymbol.STYLE_NULL,\r\n                        new SimpleLineSymbol(\r\n                            SimpleLineSymbol.STYLE_SOLID,\r\n                            new Color([255, 0, 0]), 3\r\n                        ),\r\n                        new Color([125, 125, 125, 0.35]));\r\n\r\n                    let ext = results.features[0].geometry.getExtent();\r\n\r\n                    let graphic = results.features[0].setSymbol(symbol)\r\n                    self_cw.map.graphics.add(graphic);\r\n                    self_cw.map.setExtent(ext, true);\r\n                } else {\r\n                    // alert(`No se encontro el derecho minero ${id}, por tanto no es posible su referencia en el mapa`);\r\n                    self_cw.ap_alerta_resultados_cw.classList.toggle('active');\r\n                }\r\n            }, function(error) {\r\n                alert(error);\r\n            })\r\n        }, function(error) {\r\n            alert(error);\r\n        })\r\n    },\r\n\r\n    _zoomExtendSelected(idService, whereDefinition) {\r\n        var query = new Query();\r\n        query.where = whereDefinition;\r\n        var feature = this.layersMap.getLayerInfoById(idService);\r\n        feature.getLayerObject().then(function(results) {\r\n            results.queryExtent(query, function(res) {\r\n                if (res.count) {\r\n                    self_cw.map.setExtent(res.extent, true)\r\n                } else {\r\n                    // self_cw.ap_alerta_resultados_cw.classList.toggle('active');\r\n                    alert(`No se encontro el elemento ${whereDefinition}, por tanto no es posible su referencia en el mapa`);\r\n                }\r\n\r\n            }, function(error) {\r\n                alert(error);\r\n            })\r\n        }, function(error) {\r\n            alert(error)\r\n        });\r\n    },\r\n\r\n    // Proceso que realiza la consulta\r\n    _applyQuery(evt) {\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n        switch (self_cw.controller_query) {\r\n            case 'dc':\r\n                self_cw._applyQueryDC();\r\n                // console.log('Ejecutando proces dc');\r\n                break;\r\n            case 'dm':\r\n                self_cw._applyQueryDM();\r\n                // console.log('Ejecutando proces dm');\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    _populateResultsDC(arrayResults) {\r\n        arrayResults.forEach(function(r, i) {\r\n            if (self_cw.temporal_class_results) {\r\n                var newRow = self_cw.temporal_class_results;\r\n            } else {\r\n                var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            }\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${i+1}. ${r['MINERO_INFORMAL']}`;\r\n            newRow.getElementsByClassName('title_registros_cw')[0].id = r['ID'];\r\n            dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClick);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>RUC: ${r['M_RUC']}</li>`);\r\n            fieldsList.push(`<li>Nombre DM: ${r['DERECHO_MINERO']}</li>`);\r\n            fieldsList.push(`<li>Código DM: <span class=\"tag is-primary codigou_cw\">${r['ID_UNIDAD']}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            // dojo.query('.codigou_cw').on('click', self_cw._zoomDmExtentToMap)\r\n\r\n            self_cw.ap_registros_encontrados_cw.appendChild(newRow);\r\n        });\r\n        dojo.query('.codigou_cw').on('click', self_cw._zoomDmExtentToMap);\r\n    },\r\n\r\n    _showReinfos(evt) {\r\n        let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        var elm = dojo.query(`.ul_registro_dc_${id}`);\r\n\r\n        // if (elm.length) {\r\n        //     if (elm[0].contains('active')) {\r\n        //         elm[0].hidden = true;\r\n        //         return\r\n        //     } else {\r\n        //         elm[0].hidden = false;\r\n        //         elm[0].toggle('active');\r\n        //         return\r\n        //     }\r\n        // }\r\n        if (evt.currentTarget.parentElement.classList.contains('active')) {\r\n            if (elm.length) {\r\n                evt.currentTarget.parentElement.removeChild(elm[0])\r\n                evt.currentTarget.parentElement.classList.toggle('active')\r\n            }\r\n            return;\r\n        }\r\n\r\n\r\n\r\n\r\n        // let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        let feature = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc)\r\n\r\n        let feature_sys = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc_sys)\r\n\r\n        let query = new Query();\r\n        query.where = `ID_UNIDAD = '${id}'`;\r\n\r\n        feature.setFilter(query.where);\r\n        feature.show();\r\n\r\n        feature_sys.setFilter(query.where);\r\n        feature_sys.show();\r\n\r\n        // evt.currentTarget.parentElement.classList.toggle('active')\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    evt.target.parentElement.classList.toggle('active')\r\n                    let rownum = results.features.length;\r\n                    let data = results.features.map((i) => i.attributes);\r\n                    let lidata = data.map((i, index) => `<li class=\"registro_dc\" id=\"${i['ID']}\"><a>${index}. ${i['M_RUC']} - ${i['MINERO_INFORMAL']}</a></li>`)\r\n                    let lidataString = lidata.join('');\r\n                    let ulnode = dojo.create('ul');\r\n                    ulnode.innerHTML = lidataString;\r\n                    dojo.addClass(ulnode, `ul_registro_dc_${id}`)\r\n                    evt.target.parentElement.appendChild(ulnode);\r\n                    dojo.query('.registro_dc').on('click', self_cw._showPopupRowSelectedClick)\r\n                } else {\r\n                    alert('No se encontraron REINFOS');\r\n                }\r\n            }, function(error) {\r\n                alert(error);\r\n            })\r\n        }, function(error) {\r\n            alert(error)\r\n        })\r\n    },\r\n\r\n    _populateResultsDM(arrayResults) {\r\n        arrayResults.forEach(function(r, i) {\r\n            if (self_cw.temporal_class_results) {\r\n                var newRow = self_cw.temporal_class_results;\r\n            } else {\r\n                var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            }\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${i+1}. Codigou: ${r['CODIGOU']}`;\r\n            newRow.getElementsByClassName('title_registros_cw')[0].id = r['CODIGOU'];\r\n            dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClickDM);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>Nombre DM: ${r['CONCESION']}</li>`);\r\n            fieldsList.push(`<li>Sustancia: ${r['SUSTANCIA']}</li>`);\r\n            fieldsList.push(`<li value=\"${r['CODIGOU']}\"><span class=\"tag is-primary reinfos_cw\">Ver reinfos<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n\r\n\r\n            self_cw.ap_registros_encontrados_cw.appendChild(newRow);\r\n        })\r\n        dojo.query('.reinfos_cw').on('click', self_cw._showReinfos)\r\n    },\r\n\r\n    _showPopupRowSelectedClick(evt) {\r\n        var id_row = evt.currentTarget.id;\r\n\r\n        var id_layer = self_cw.config.layer_id_dc;\r\n        var id_layer_sys = self_cw.config.layer_id_dc_sys;\r\n\r\n        var feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n        var feature_sys = self_cw.layersMap.getLayerInfoById(id_layer_sys);\r\n\r\n        var whereDefinition = `ID = ${id_row}`\r\n\r\n        feature_sys.setFilter(whereDefinition);\r\n\r\n        feature_sys.layerObject.queryFeatures(whereDefinition, function(results) {\r\n            var center = results.features[0].geometry;\r\n            self_cw._openPopupAutocamitcally(feature, center, whereDefinition);\r\n        })\r\n\r\n    },\r\n\r\n    _openPopupAutocamitcally2(featureLayer, center) {\r\n        self_cw.map.infoWindow.setFeatures(featureLayer.features);\r\n        self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        self_cw.map.centerAt(center);\r\n    },\r\n\r\n    _showPopupRowSelectedClickDM(evt) {\r\n        let id_row = evt.currentTarget.id;\r\n\r\n        let id_layer = self_cw.config.layer_id_dm;\r\n\r\n        let feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n\r\n        let whereDefinition = `CODIGOU = '${id_row}'`\r\n\r\n        query = new Query();\r\n        query.where = whereDefinition;\r\n\r\n        // feature_sys.setFilter(whereDefinition);\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    let center = results.features[0].geometry.getCentroid();\r\n                    let ext = results.features[0].geometry.getExtent();\r\n                    self_cw._openPopupAutocamitcally2(results, center, query);\r\n                    self_cw.map.setExtent(ext, true);\r\n                }\r\n            }, function(error) {\r\n                alert(error);\r\n            })\r\n        }, function(error) {\r\n            alert(error);\r\n        });\r\n\r\n        // feature_sys.layerObject.queryFeatures(whereDefinition, function(results) {\r\n        //     var center = results.features[0].geometry;\r\n        //     self_cw._openPopupAutocamitcally(feature, center, whereDefinition);\r\n        // })\r\n    },\r\n\r\n    _applyQueryDC() {\r\n        whereDefinitionArray = []\r\n\r\n        // self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n\r\n        if (self_cw.input_ruc_dc_cw.value != '') {\r\n            var ruc_dc = `(m_ruc like '%${self_cw.input_ruc_dc_cw.value}%')`;\r\n            whereDefinitionArray.push(ruc_dc);\r\n        }\r\n\r\n        var nombre_dc = `(lower(minero_informal) like lower('%${self_cw.input_nombre_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombre_dc);\r\n\r\n        if (self_cw.select_tipo_persona_cw.value != '') {\r\n            var tipo_persona_dc = `(tipo_persona like '%${self_cw.select_tipo_persona_cw.value}%')`;\r\n            whereDefinitionArray.push(tipo_persona_dc);\r\n        };\r\n\r\n        var codigou_dc = `(upper(id_unidad) like upper('%${self_cw.input_codigou_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dc);\r\n\r\n        var nombredm_dc = `(lower(derecho_minero) like lower('%${self_cw.input_nombre_dm_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dc);\r\n\r\n        var ubigeo_dc = `(id_ubigeo_inei like '${self_cw.controller_ubigeo}%')`;\r\n        whereDefinitionArray.push(ubigeo_dc);\r\n\r\n        var whereDefinition = whereDefinitionArray.join(' and ');\r\n\r\n        // Filtro a capa DC visible en la TOC\r\n        var id = self_cw.config.layer_id_dc;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id);\r\n        feature.setFilter(whereDefinition);\r\n        feature.show();\r\n\r\n        // Filtro a capa DC sistema no visible en la TOC\r\n        var id_sys = self_cw.config.layer_id_dc_sys;\r\n        var feature_sys = self_cw.layersMap.getLayerInfoById(id_sys);\r\n        feature_sys.setFilter(whereDefinition);\r\n        feature_sys.show();\r\n\r\n        // Ocultando los mensajes de alerta frente a errores\r\n        self_cw.ap_alerta_resultados_cw.classList.remove('active');\r\n\r\n        // Realizando el query a la capa\r\n        feature.layerObject.queryFeatures(whereDefinition, function(result) {\r\n            var rowcount = result.features.length;\r\n            self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n            self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n            var data = result.features.map((i) => i.attributes);\r\n            // console.log(data);\r\n\r\n            self_cw._populateResultsDC(data)\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n        });\r\n\r\n        // if (self_cw.ap_indicador_resultados_cw.innerText == '0') {\r\n        //     return\r\n        // };\r\n\r\n        feature_sys.layerObject.queryExtent(whereDefinition, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        })\r\n\r\n        // List results\r\n        // Change view results\r\n        // Open popup when click list\r\n    },\r\n\r\n    _applyQueryDM() {\r\n        whereDefinitionArray = []\r\n        var codigou_dm = `(upper(codigou) like upper('%${self_cw.input_codigou_dm_cw.value}%'))`;\r\n        var nombredm_dm = `(lower(concesion) like lower('%${self_cw.input_nombre_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dm)\r\n        whereDefinitionArray.push(nombredm_dm)\r\n\r\n        var whereDefinition = whereDefinitionArray.join(' and ');\r\n\r\n        // console.log(whereDefinition);\r\n\r\n        // Filtro a capa DC visible en la TOC\r\n        var id = self_cw.config.layer_id_dm;\r\n        var feature = self_cw.layersMap.getLayerInfoById(id);\r\n        feature.setFilter(whereDefinition);\r\n        feature.show();\r\n\r\n        self_cw.ap_alerta_resultados_cw.classList.remove('active');\r\n\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n\r\n        feature.getLayerObject().then(\r\n            function(response) {\r\n                response.queryFeatures(query, function(results) {\r\n                    let rowcount = results.features.length;\r\n                    self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n                    self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n                    if (rowcount) {\r\n                        var data = results.features.map((i) => i.attributes);\r\n                        self_cw._populateResultsDM(data)\r\n                    }\r\n                    self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n                    var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n                    if (!class_list_container_resultados.contains('active')) {\r\n                        self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n                    }\r\n                    self_cw.ap_resultados_cw.click();\r\n\r\n                }, function(error) {\r\n                    alert(error);\r\n                });\r\n                response.queryExtent(query, function(results) {\r\n                    if (results.count) {\r\n                        self_cw.map.setExtent(results.extent, true)\r\n                    } else {\r\n                        alert(`No se encontraron elementos`);\r\n                    }\r\n                }, function(error) {\r\n                    alert(error);\r\n                })\r\n            },\r\n            function(error) {\r\n                alert(error);\r\n            }\r\n        )\r\n    },\r\n\r\n    startup() {\r\n        this.inherited(arguments);\r\n        console.log('Consulta_wgt::startup');\r\n        self_cw._addEventToTabsOptions();\r\n        self_cw._addEventToLayerQuery();\r\n        self_cw._getDataByTipoPersona();\r\n        self_cw._getDataByDepartamento()\r\n    },\r\n    onOpen() {\r\n        console.log('Consulta_wgt::onOpen');\r\n    },\r\n    // onClose(){\r\n    //   console.log('Consulta_wgt::onClose');\r\n    // },\r\n    // onMinimize(){\r\n    //   console.log('Consulta_wgt::onMinimize');\r\n    // },\r\n    // onMaximize(){\r\n    //   console.log('Consulta_wgt::onMaximize');\r\n    // },\r\n    // onSignIn(credential){\r\n    //   console.log('Consulta_wgt::onSignIn', credential);\r\n    // },\r\n    // onSignOut(){\r\n    //   console.log('Consulta_wgt::onSignOut');\r\n    // }\r\n    // onPositionChange(){\r\n    //   console.log('Consulta_wgt::onPositionChange');\r\n    // },\r\n    // resize(){\r\n    //   console.log('Consulta_wgt::resize');\r\n    // }\r\n});"]}