{"version":3,"sources":["../../../widgets/Consulta_wgt/Widget.js"],"names":["declare","_WidgetsInTemplateMixin","BaseWidget","lang","LayerInfos","Query","QueryTask","StatisticDefinition","FeatureLayer","GraphicsLayer","Graphic","SimpleFillSymbol","SimpleLineSymbol","SimpleMarkerSymbol","Color","Message","BusyIndicator","baseClass","iniClause","layersMap","field_dep_nm_depa","field_dep_cd_depa","field_prov_nm_prov","field_prov_cd_prov","field_dist_nm_dist","field_dist_cd_dist","field_codigou_dm","field_concesion_dm","field_sustancia_dm","field_id","field_minero_informal","field_minero_informal_rep","field_m_ruc","field_derecho_minero","field_id_unidad","field_tipo_persona","field_id_ubigeo_inei","field_id_tb","field_minero_informal_tb","field_m_ruc_tb","field_derecho_minero_tb","field_id_unidad_tb","field_tipo_persona_tb","field_id_ubigeo_inei_tb","controller_query","controller_layer_query","controller_ubigeo","temporal_class_results","feature_dc","feature_dm","numero_registros","numero_paginas","registros_pagina","pagina_actual","grupo_actual","grupos_paginas","factor","whereDefinition","postCreate","self_cw","inherited","arguments","_getAllLayers","getLayerInfoById","config","layer_id_dc","feature_dc_table","getTableInfoById","table_id_dc","layer_id_dm","feature_dep","layer_id_dep","feature_prov","layer_id_prov","feature_dist","layer_id_dist","getInstance","map","itemInfo","then","hitch","layerInfosObj","_showMessage","message","type","messagebox","titleLabel","nls","_widgetLabel","buttons","label","onClick","close","_cleanMap","_getDataByTipoPersona","id","query","where","returnGeometry","returnDistinctValues","outFields","layerObject","queryFeatures","results","features","length","forEach","opt","document","createElement","value","i","attributes","text","select_tipo_persona_cw","add","selected","error_tipo_persona_count","error","error_tipo_persona","_getDataByDepartamento","queryTask","getUrl","orderByFields","execute","departamento_cw","error_departamento_count","error_departamento","_getDataByProvincia","evt","busyIndicator","show","cd_depa","target","distrito_cw","innerHTML","container_distrito_cw","classList","remove","container_provincia_cw","hide","contains","toggle","_zoomExtendSelected","fragment","createDocumentFragment","provincia_cw","appendChild","error_provincia_count","error_provincia","_getDataByDistrito","cd_prov","substring","error_distrito_count","error_distrito","_getDistritoSelected","cd_dist","_addEventToLayerQuery","dojo","on","_setFormContainer","title","currentTarget","innerText","titulo_consulta","ListaCapasConsulta","hidden","nodeContainer_cw","toggleClass","node","dataset","dojoAttachPoint","includes","_returnListaCapasConsulta","_addEventToTabsOptions","_connectTabsWithOptionContainer","option","toLowerCase","container_option","_validateRucNumber","val","replace","_openPopupAutocamitcally","featureInfo","center","infoWindow","setFeatures","getInfoWindowAnchor","centerAt","_openPopupAutocamitcally2","featureLayer","_zoomDmExtentToMap","setFilter","getLayerObject","response","ext","geometry","getExtent","getCentroid","setExtent","none_element","none_reference_map","error_query_feature","feature","error_service","queryExtent","res","count","extent","_applyQuery","ap_registros_encontrados_cw","_applyQueryDC2","_applyQueryDM2","_cloneNode","clone","nodeType","createTextNode","nodeValue","cloneNode","child","firstChild","nextSibling","_rowNode","parser","DOMParser","doc","parseFromString","body","childNodes","_populateResultsDC","arrayResults","enumerate_ini","r","newRow","style","display","getElementsByClassName","fieldsList","push","field_dc_ruc","field_nombre_dm","fieldsListNode","join","_showPopupRowSelectedClick","_showReinfos","parentElement","getAttribute","elm","removeChild","rownum","show_reinfos","data","lidata","index","lidataString","ulnode","create","addClass","none_element_pl","_populateResultsDM","_showPopupRowSelectedClickDM","id_row","selectFeatures","SELECTION_NEW","error_none_geometry","catch","expand","startup","console","log","domNode","parentNode","backgroundOpacity","onOpen","lyr_dc","lyr_dm","container_resultados_opcion_cw","ap_none_resultados_opcion_cw","onClose","clean_map_question","_queryDcGeneral","queryCount","ap_indicador_resultados_cw","ap_titulo_resultados_cw","_generatePages","_queryDcByPage","busyIndicator_lw","queryDmGeneral","queryIds","_queryDmByPage","n","ap_titulo_registros_resultados_cw","ap_resultados_cw","click","num","start","fin","String","result","rowcount","ids","ids_join","query_ids","class_list_container_resultados","ap_anterior_page_cw","setAttribute","ap_siguiente_page_cw","removeAttribute","_queryDcByPageEvent","page","parseInt","_queryDmByPageEvent","_nextPage","_generatePagesFromArray","_backPage","ap_pagination_cw","ap_pagination_list_cw","Math","ceil","_generateGroupsPages","paginas","Array","from","keys","slice","grupos","grupos_array","pages","pages_html_array","class_element","splice","pages_html","whereDefinitionArray","ruc_dc","input_ruc_dc_cw","nombre_dc","input_nombre_dc_cw","tipo_persona_dc","codigou_dc","input_codigou_dc_cw","nombredm_dc","input_nombre_dm_dc_cw","ubigeo_dc","codigou_dm","input_codigou_dm_cw","nombredm_dm","input_nombre_dm_cw"],"mappings":"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","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\n// import query from \"dojo/query\";\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport StatisticDefinition from \"esri/tasks/StatisticDefinition\";\r\n// import InfoTemplate from \"esri/InfoTemplate\";\r\nimport FeatureLayer from \"esri/layers/FeatureLayer\";\r\n\r\nimport GraphicsLayer from \"esri/layers/GraphicsLayer\";\r\nimport Graphic from 'esri/graphic';\r\n\r\nimport SimpleFillSymbol from \"esri/symbols/SimpleFillSymbol\";\r\nimport SimpleLineSymbol from 'esri/symbols/SimpleLineSymbol';\r\nimport SimpleMarkerSymbol from 'esri/symbols/SimpleMarkerSymbol';\r\nimport Color from 'dojo/_base/Color';\r\n\r\nimport Message from \"jimu/dijit/Message\";\r\n// import 'jimu/dijit/LoadingIndicator';\r\n// import 'jimu/dijit/LoadingShelter'\r\nimport BusyIndicator from 'esri/dijit/util/busyIndicator';\r\n// import domConstruct from 'dojo/dom-construct';\r\n// import on from 'dojo/on';\r\n// import domClass from \"dojo/dom-class\";\r\n// import \"dojo/domReady!\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([BaseWidget, _WidgetsInTemplateMixin, Query,\r\n    QueryTask,\r\n    StatisticDefinition,\r\n    // FeatureLayer\r\n], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'consulta-wgt',\r\n    iniClause: '1=1',\r\n\r\n    layersMap: [],\r\n\r\n    field_dep_nm_depa: 'NM_DEPA',\r\n    field_dep_cd_depa: 'CD_DEPA',\r\n\r\n    field_prov_nm_prov: 'NM_PROV',\r\n    field_prov_cd_prov: 'CD_PROV',\r\n\r\n    field_dist_nm_dist: 'NM_DIST',\r\n    field_dist_cd_dist: 'CD_DIST',\r\n\r\n\r\n    // // Campos DM Ingemmet\r\n    // field_codigou_dm: 'CODIGOU',\r\n    // field_concesion_dm: 'CONCESION',\r\n    // field_sustancia_dm: 'SUSTANCIA',\r\n\r\n    //  Campos DM Minem\r\n    field_codigou_dm: 'ID_UNIDAD',\r\n    field_concesion_dm: 'NOMBRE',\r\n    field_sustancia_dm: 'ID_CLASE_SUSTANCIA',\r\n\r\n    // Campos DC\r\n    field_id: 'ESRI_OID', // Objectid del minero informal\r\n    field_minero_informal: 'NOMBRE_MIN', // Nombre del minero informal\r\n    field_minero_informal_rep: 'NOMBRE_REP', // Nombre del representante\r\n    field_m_ruc: 'M_RUC', // RUC del minero informal\r\n    field_derecho_minero: 'NOMBRE_DM', // Nombre del derecho mineroo\r\n    field_id_unidad: 'CODIGOU', // Identificador del derecho minero (CODIGOU)\r\n    field_tipo_persona: 'M_TIPO_PERSONA', // Tipo de persona (natural, juridica)\r\n    field_id_ubigeo_inei: 'CD_DIST', // Ubigeo\r\n\r\n    // Campos Tabla DC\r\n    field_id_tb: 'ESRI_OID', // Objectid del minero informal\r\n    field_minero_informal_tb: 'NOMBRE_MIN', // Nombre del minero informal\r\n    // field_minero_informal_rep_tb: 'NOMBRE_REP', // Nombre del representante\r\n    field_m_ruc_tb: 'M_RUC', // RUC del minero informal\r\n    field_derecho_minero_tb: 'NOMBRE_DM', // Nombre del derecho mineroo\r\n    field_id_unidad_tb: 'CODIGOU', // Identificador del derecho minero (CODIGOU)\r\n    field_tipo_persona_tb: 'M_TIPO_PERSONA', // Tipo de persona (natural, juridica)\r\n    field_id_ubigeo_inei_tb: 'CD_DIST', // Ubigeo\r\n\r\n    controller_query: '', // Permite identificar la opcion de consulta seleccionada\r\n    controller_layer_query: false,\r\n\r\n    controller_ubigeo: '',\r\n\r\n    temporal_class_results: '',\r\n\r\n    feature_dc: null,\r\n    feature_dm: null,\r\n\r\n    numero_registros: 0,\r\n    numero_paginas: 0,\r\n    registros_pagina: 1000,\r\n    pagina_actual: 1,\r\n    grupo_actual: 0,\r\n    grupos_paginas: [],\r\n    factor: 4,\r\n    whereDefinition: '',\r\n\r\n    // add additional properties here\r\n\r\n    // methods to communication with app container:\r\n    postCreate() {\r\n        self_cw = this;\r\n        this.inherited(arguments);\r\n        // console.log('Consulta_wgt::postCreate');;\r\n        this._getAllLayers();\r\n        this.feature_dc = this.layersMap.getLayerInfoById(this.config.layer_id_dc);\r\n        this.feature_dc_table = this.layersMap.getTableInfoById(this.config.table_id_dc);\r\n        this.feature_dm = this.layersMap.getLayerInfoById(this.config.layer_id_dm);\r\n        this.feature_dep = this.layersMap.getLayerInfoById(this.config.layer_id_dep);\r\n        this.feature_prov = this.layersMap.getLayerInfoById(this.config.layer_id_prov);\r\n        this.feature_dist = this.layersMap.getLayerInfoById(this.config.layer_id_dist);\r\n    },\r\n\r\n    _getAllLayers() {\r\n        LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n            .then(lang.hitch(this, function(layerInfosObj) {\r\n                this.layersMap = layerInfosObj;\r\n            }));\r\n    },\r\n\r\n    _showMessage(message, type = 'message') {\r\n        switch (type) {\r\n            case 'question':\r\n                let messagebox = new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                    buttons: [{\r\n                        label: 'SI',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            messagebox.close();\r\n                        }))\r\n                    }, {\r\n                        label: 'NO',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            this._cleanMap();\r\n                            messagebox.close();\r\n                        }))\r\n                    }]\r\n                });\r\n\r\n                break;\r\n            default:\r\n                new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                });\r\n                break;\r\n        }\r\n\r\n    },\r\n\r\n    // Metodos para agregar opciones a las etiquetas 'select'\r\n    _getDataByTipoPersona() {\r\n        let id = this.config.layer_id_dc\r\n            // let feature_dc = this.layersMap.getLayerInfoById(id);\r\n        let query = new Query();\r\n        query.where = `${this.field_tipo_persona} IS NOT NULL`;\r\n        query.returnGeometry = false;\r\n        query.returnDistinctValues = true;\r\n        query.outFields = [this.field_tipo_persona];\r\n\r\n        self_cw.feature_dc.layerObject.queryFeatures(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_tipo_persona];\r\n                    opt.text = i.attributes[self_cw.field_tipo_persona];\r\n                    self_cw.select_tipo_persona_cw.add(opt);\r\n                });\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.select_tipo_persona_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_tipo_persona_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_tipo_persona}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n    _getDataByDepartamento() {\r\n        let id = this.config.layer_id_dep\r\n        let feature_dep = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dep.getUrl());\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} <> 99`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dep_nm_depa, this.field_dep_cd_depa];\r\n        query.orderByFields = [this.field_dep_nm_depa];\r\n        queryTask.execute(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                results.features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dep_cd_depa];\r\n                    opt.text = i.attributes[self_cw.field_dep_nm_depa];\r\n                    self_cw.departamento_cw.add(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.departamento_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_departamento_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_departamento}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n\r\n    _getDataByProvincia(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona un departamento\r\n        // Carga las provincias pertenecientes al departamento seleccionado\r\n        // Realiza el zoom en el mapa al departamento seleccionado\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_depa = evt.target.value;\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_depa;\r\n\r\n        this.distrito_cw.innerHTML = '';\r\n        this.container_distrito_cw.classList.remove('active');\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de departamentos\r\n        if (cd_depa == '') {\r\n            // Removemos el combo de provincias\r\n            this.container_provincia_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            // Salimos del evento\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de provincias no esta activo\r\n        if (!this.container_provincia_cw.classList.contains('active')) {\r\n            // Activar el contenedor de provincias\r\n            this.container_provincia_cw.classList.toggle('active');\r\n        };\r\n\r\n        // Obteniendo el LayerObject de provincias\r\n        let id = this.config.layer_id_prov\r\n        let feature_prov = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_prov.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener las provincias del departamento\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} = '${cd_depa}'`;\r\n\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_prov_nm_prov, this.field_prov_cd_prov];\r\n        query.orderByFields = [this.field_prov_nm_prov];\r\n\r\n        self_cw._zoomExtendSelected(self_cw.feature_dep, query.where);\r\n\r\n        // Ejecucion de consulta para obtener las opciones de provincias\r\n        queryTask.execute(query, function(results) {\r\n            let fragment = document.createDocumentFragment();\r\n            // Zoom al departamento seleccionado\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                self_cw.provincia_cw.innerHTML = '';\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_prov_cd_prov];\r\n                    opt.text = i.attributes[self_cw.field_prov_nm_prov];\r\n                    // self_cw.provincia_cw.add(opt);\r\n                    fragment.appendChild(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                fragment.appendChild(opt);\r\n                // self_cw.provincia_cw.add(opt);\r\n                self_cw.provincia_cw.appendChild(fragment);\r\n\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_provincia_count}`)\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_provincia}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n    },\r\n\r\n    _getDataByDistrito(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una provincia\r\n        // Carga las provincias pertenecientes a la provincia seleccionada\r\n        // Realiza el zoom en el mapa a la provincia seleccionada\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_prov = evt.target.value;\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de provincias\r\n        if (cd_prov == '') {\r\n            // Anulamos los dos ultimos digitos del controlador de ubigeo\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 2);\r\n            // Ocultamos el selector de distritos\r\n            this.container_distrito_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de distrito no esta activo\r\n        if (!this.container_distrito_cw.classList.contains('active')) {\r\n            // Activar el contenedor de distrito\r\n            this.container_distrito_cw.classList.toggle('active');\r\n        }\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_prov;\r\n\r\n        // Obteniendo el LayerObject de distritos\r\n        let id = this.config.layer_id_dist;\r\n        let feature_dist = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dist.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener los distritos de la provincia\r\n        let query = new Query();\r\n        query.where = `${this.field_prov_cd_prov} = '${cd_prov}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dist_nm_dist, this.field_dist_cd_dist];\r\n        query.orderByFields = [this.field_dist_nm_dist];\r\n\r\n        self_cw._zoomExtendSelected(self_cw.feature_prov, query.where);\r\n\r\n        // Ejecucion de consulta para obtener las opciones de distritos\r\n        queryTask.execute(query, function(results) {\r\n            let fragment = document.createDocumentFragment();\r\n            // Zoom a la provincia seleccionada\r\n            // self_cw._zoomExtendSelected(self_cw.config.layer_id_prov, query.where);\r\n            self_cw.distrito_cw.innerHTML = \"\";\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dist_cd_dist];\r\n                    opt.text = i.attributes[self_cw.field_dist_nm_dist];\r\n                    // self_cw.distrito_cw.add(opt);\r\n                    fragment.appendChild(opt)\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                // self_cw.distrito_cw.add(opt);\r\n                fragment.appendChild(opt);\r\n                self_cw.distrito_cw.appendChild(fragment)\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_distrito_count}`);\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_distrito}\\n${error.message}`, type = 'error');\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n    },\r\n\r\n    _getDistritoSelected(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una distrito\r\n        // Realiza el zoom en el mapa al distrito seleccionado\r\n        var cd_dist = evt.target.value;\r\n        whereDefinition = `${this.field_dist_cd_dist} = '${cd_dist}'`\r\n        if (cd_dist == '') {\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 4)\r\n            return\r\n        }\r\n        this.controller_ubigeo = cd_dist;\r\n        this._zoomExtendSelected(this.feature_dist, whereDefinition);\r\n        // this._zoomExtendSelected(this.config.layer_id_dist, whereDefinition);\r\n    },\r\n\r\n    // Metodos dedicados al frontend del widget\r\n\r\n    _addEventToLayerQuery() {\r\n        dojo.query(\".capa_consulta_cw\").on('click', this._setFormContainer);\r\n    },\r\n\r\n    _setFormContainer(evt) {\r\n        var title = evt.currentTarget.innerText;\r\n\r\n        self_cw.controller_query = evt.currentTarget.id;\r\n        self_cw.titulo_consulta.innerText = title\r\n        self_cw.ListaCapasConsulta.hidden = true;\r\n\r\n        var nodeContainer_cw = dojo.query(\".container_cw\")\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active')\r\n        dojo.query('.formulario_cw').forEach(function(node) {\r\n            if (node.dataset.dojoAttachPoint.includes(self_cw.controller_query)) {\r\n                node.hidden = false;\r\n            } else {\r\n                node.hidden = true;\r\n            }\r\n        })\r\n    },\r\n\r\n    _returnListaCapasConsulta() {\r\n        var nodeContainer_cw = dojo.query(\".container_cw\");\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active');\r\n        this.ListaCapasConsulta.hidden = false;\r\n    },\r\n\r\n    _addEventToTabsOptions() {\r\n        dojo.query('.opcion_cw').on('click', this._connectTabsWithOptionContainer)\r\n    },\r\n\r\n    _connectTabsWithOptionContainer(evt) {\r\n        var option = evt.currentTarget.innerText.toLowerCase();\r\n        if (evt.currentTarget.classList.contains('is-active')) {\r\n            return\r\n        };\r\n        dojo.query('.opcion_cw').forEach(function(node) {\r\n            var container_option = self_cw[`${node.id}_${node.classList[0]}`]\r\n            if (node.innerText.toLowerCase() == option) {\r\n                node.classList.toggle('is-active')\r\n                container_option.classList.toggle('active')\r\n            } else {\r\n                node.classList.remove('is-active');\r\n                container_option.classList.remove('active')\r\n            }\r\n        });\r\n    },\r\n\r\n    _validateRucNumber(evt) {\r\n        var val = evt.currentTarget.value;\r\n        evt.currentTarget.value = val.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');\r\n    },\r\n\r\n    // Interaccion con el mapa\r\n\r\n    _openPopupAutocamitcally(featureInfo, center, whereDefinition) {\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n        featureInfo.layerObject.queryFeatures(query, function(results) {\r\n            self_cw.map.infoWindow.setFeatures(results.features);\r\n            self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n            self_cw.map.centerAt(center);\r\n\r\n            // self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        });\r\n\r\n    },\r\n\r\n    _openPopupAutocamitcally2(featureLayer, center) {\r\n        self_cw.map.infoWindow.setFeatures(featureLayer.features);\r\n        self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        self_cw.map.centerAt(center);\r\n    },\r\n\r\n    _zoomDmExtentToMap(evt) {\r\n\r\n        // self_cw._applyQueryDM.click()\r\n        let id = evt.currentTarget.innerText;\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${id}'`\r\n            // let id_layer = self_cw.config.layer_id_dm;\r\n            // let feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n        self_cw.feature_dm.setFilter(query.where);\r\n        self_cw.feature_dm.show();\r\n\r\n        self_cw.feature_dm.getLayerObject().then(function(response) {\r\n            // self_cw.map.graphics.clear();\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    // let symbol = new SimpleFillSymbol(\r\n                    //     SimpleFillSymbol.STYLE_NULL,\r\n                    //     new SimpleLineSymbol(\r\n                    //         SimpleLineSymbol.STYLE_SOLID,\r\n                    //         new Color([255, 0, 0]), 3\r\n                    //     ),\r\n                    //     new Color([125, 125, 125, 0.35]));\r\n\r\n                    let ext = results.features[0].geometry.getExtent();\r\n                    let center = results.features[0].geometry.getCentroid();\r\n\r\n                    // let graphic = results.features[0].setSymbol(symbol)\r\n                    // self_cw.map.graphics.add(graphic);\r\n                    self_cw.map.infoWindow.setFeatures(results.features);\r\n                    self_cw.map.infoWindow.show(center);\r\n                    // self_cw.map.centerAt(center);\r\n                    // self_cw._openPopupAutocamitcally2(results, center);\r\n                    self_cw.map.setExtent(ext, true);\r\n\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${id}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        })\r\n    },\r\n\r\n    _zoomExtendSelected(feature, whereDefinition) {\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n        // let feature = this.layersMap.getLayerInfoById(idService);\r\n        feature.getLayerObject().then(function(results) {\r\n            results.queryExtent(query, function(res) {\r\n                if (res.count) {\r\n                    self_cw.map.setExtent(res.extent, true)\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${whereDefinition}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        });\r\n    },\r\n\r\n    // Proceso que realiza la consulta\r\n    _applyQuery(evt) {\r\n        this.busyIndicator.show();\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n        switch (self_cw.controller_query) {\r\n            case 'dc':\r\n                // self_cw._applyQueryDC()\r\n                self_cw._applyQueryDC2();\r\n                break;\r\n            case 'dm':\r\n                // self_cw._applyQueryDM();\r\n                self_cw._applyQueryDM2()\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    _cloneNode(node) {\r\n        var clone = node.nodeType == 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\r\n        var child = node.firstChild;\r\n        while (child) {\r\n            clone.appendChild(self_cw._cloneNode(child));\r\n            child = child.nextSibling;\r\n        }\r\n        return clone;\r\n    },\r\n\r\n    _rowNode() {\r\n        let node = `<li style=\"display: none;\" data-dojo-attach-point=\"ap_template_registros_resultados_cw\">\r\n                        <a class=\"container_head_registros_cw\">\r\n                            <div class=\"columns is-mobile\">\r\n                                <div class=\"column is-four-fifths title_registros_cw\"></div>\r\n                                <div class=\"column has-text-right\"><span class=\"icon has-text-info\"><i class=\"fas fa-search\"></i></span></div>\r\n                            </div>\r\n                        </a>\r\n                        <ul class=\"detalle_registros_resultados_cw\">\r\n                        </ul>\r\n                    </li>`;\r\n        var parser = new DOMParser();\r\n        var doc = parser.parseFromString(node, 'text/html');\r\n        return doc.body.childNodes[0];\r\n    },\r\n\r\n    _populateResultsDC(arrayResults, enumerate_ini = 1) {\r\n        let fragment = document.createDocumentFragment();\r\n        arrayResults.forEach(function(r, i) {\r\n            let newRow = self_cw._rowNode();\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            // var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${enumerate_ini}. ${r[self_cw.field_minero_informal]}`;\r\n            newRow.getElementsByClassName('container_head_registros_cw')[0].id = r[self_cw.field_id];\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_dc_ruc}: ${r[self_cw.field_m_ruc]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_derecho_minero]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_codigou_dm}: <span class=\"tag is-primary codigou_cw\">${r[self_cw.field_id_unidad]}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            fragment.appendChild(newRow);\r\n            enumerate_ini = enumerate_ini + 1\r\n        });\r\n        self_cw.ap_registros_encontrados_cw.appendChild(fragment);\r\n        dojo.query('.container_head_registros_cw').on('click', self_cw._showPopupRowSelectedClick);\r\n        dojo.query('.codigou_cw').on('click', self_cw._zoomDmExtentToMap);\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showReinfos(evt) {\r\n        self_cw.busyIndicator.show();\r\n        let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        var elm = dojo.query(`.ul_registro_dc_${id}`);\r\n\r\n        if (evt.currentTarget.parentElement.classList.contains('active')) {\r\n            if (elm.length) {\r\n                evt.currentTarget.parentElement.removeChild(elm[0])\r\n                evt.currentTarget.parentElement.classList.toggle('active')\r\n            }\r\n            self_cw.busyIndicator.hide();\r\n            return;\r\n        }\r\n\r\n        // let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        // let feature = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc)\r\n\r\n        let query = new Query();\r\n        query.where = `(${self_cw.field_id_unidad} = '${id}') and (${self_cw.field_m_ruc} is not null)`;\r\n\r\n        self_cw.feature_dc.setFilter(query.where);\r\n        self_cw.feature_dc.show();\r\n\r\n        // feature_sys.setFilter(query.where);\r\n        // feature_sys.show();\r\n\r\n        // evt.currentTarget.parentElement.classList.toggle('active')\r\n\r\n        self_cw.feature_dc.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    evt.target.parentElement.classList.toggle('active')\r\n                    let rownum = results.features.length;\r\n                    evt.target.innerText = `${self_cw.nls.show_reinfos} (${rownum})`\r\n                    let data = results.features.map((i) => i.attributes);\r\n                    let lidata = data.map((i, index) => `<li class=\"registro_dc\" id=\"${i[self_cw.field_id]}\"><a>${index + 1}. ${i[self_cw.field_m_ruc]} - ${i[self_cw.field_tipo_persona].toLowerCase() == 'juridica' ? i[self_cw.field_minero_informal_rep] : i[self_cw.field_minero_informal]}</a></li>`)\r\n                    let lidataString = lidata.join('');\r\n                    let ulnode = dojo.create('ul');\r\n                    ulnode.innerHTML = lidataString;\r\n                    dojo.addClass(ulnode, `ul_registro_dc_${id}`)\r\n                    evt.target.parentElement.appendChild(ulnode);\r\n                    dojo.query('.registro_dc').on('click', self_cw._showPopupRowSelectedClick)\r\n                } else {\r\n                    evt.target.innerText = `${self_cw.nls.show_reinfos} (0)`\r\n                    self_cw._showMessage(self_cw.nls.none_element_pl);\r\n                };\r\n                self_cw.busyIndicator.hide();\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n                self_cw.busyIndicator.hide();\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        })\r\n    },\r\n\r\n    _populateResultsDM(arrayResults, enumerate_ini = 1) {\r\n        let fragment = document.createDocumentFragment();\r\n        arrayResults.forEach(function(r, i) {\r\n            // if (self_cw.temporal_class_results) {\r\n            //     var newRow = self_cw.temporal_class_results;\r\n            // } else {\r\n            //     var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            // }\r\n            let newRow = self_cw._rowNode();\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            // var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${enumerate_ini}. ${self_cw.nls.field_codigou_dm}: ${r[self_cw.field_codigou_dm]}`;\r\n            // newRow.getElementsByClassName('title_registros_cw')[0].id = r[self_cw.field_codigou_dm];\r\n            newRow.getElementsByClassName('container_head_registros_cw')[0].id = r[self_cw.field_codigou_dm];\r\n            // dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClickDM);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_concesion_dm]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_sustancia_dm}: ${r[self_cw.field_sustancia_dm]}</li>`);\r\n            fieldsList.push(`<li value=\"${r[self_cw.field_codigou_dm]}\"><span class=\"tag is-primary reinfos_cw\">${self_cw.nls.show_reinfos}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            fragment.appendChild(newRow);\r\n            enumerate_ini = enumerate_ini + 1;\r\n        })\r\n        self_cw.ap_registros_encontrados_cw.appendChild(fragment);\r\n        dojo.query('.container_head_registros_cw').on('click', self_cw._showPopupRowSelectedClickDM);\r\n        dojo.query('.reinfos_cw').on('click', self_cw._showReinfos);\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showPopupRowSelectedClick(evt) {\r\n        let id_row = evt.currentTarget.id;\r\n\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_id} = ${id_row}`\r\n\r\n        self_cw.feature_dc.layerObject.selectFeatures(query, FeatureLayer.SELECTION_NEW)\r\n            .then(\r\n                function(response) {\r\n                    let center = response[0].geometry;\r\n                    if (!center) {\r\n                        self_cw._showMessage(self_cw.nls.error_none_geometry);\r\n                        return;\r\n                    }\r\n\r\n                    self_cw.map.infoWindow.setFeatures(response);\r\n                    self_cw.map.infoWindow.show(center);\r\n                    self_cw.map.centerAt(center);\r\n\r\n                },\r\n                function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dc.title} (${query.where})\\n${error.message}`);\r\n                })\r\n            .catch(function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dc.title}\\n${error.message}`);\r\n            })\r\n\r\n    },\r\n\r\n\r\n\r\n    _showPopupRowSelectedClickDM(evt) {\r\n        let id = evt.currentTarget.id;\r\n\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${id}'`;\r\n        query.returnGeometry = true;\r\n        query.outFields = ['*'];\r\n\r\n        let queryTask = new QueryTask(self_cw.feature_dm.getUrl());\r\n        queryTask.execute(query, function(results) {\r\n            let center = results.features[0].geometry.getCentroid();\r\n            if (!center) {\r\n                self_cw._showMessage(self_cw.nls.error_none_geometry);\r\n                return;\r\n            };\r\n            let ext = results.features[0].geometry.getExtent();\r\n            self_cw.feature_dm.layerObject.selectFeatures(query, FeatureLayer.SELECTION_NEW).then(\r\n                function(response) {\r\n                    self_cw.map.infoWindow.setFeatures(response);\r\n                    self_cw.map.infoWindow.show(center);\r\n                    self_cw.map.setExtent(ext.expand(1.6), true);\r\n                },\r\n                function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dm.title} (${query.where})\\n${error.message}`);\r\n                }\r\n            );\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dm.title} (${query.where})\\n${error.message}`);\r\n        });\r\n    },\r\n\r\n    startup() {\r\n        this.inherited(arguments);\r\n        console.log('Consulta_wgt::startup');\r\n        this.busyIndicator = BusyIndicator.create({\r\n            target: this.domNode.parentNode.parentNode.parentNode,\r\n            backgroundOpacity: 0\r\n        });\r\n        this.busyIndicator.show();\r\n\r\n        // var panel = this.getPanel();\r\n        // var pos = panel.position;\r\n        // pos.width = 450;\r\n        // panel.setPosition(pos);\r\n        // panel.panelManager.normalizePanel(panel);\r\n\r\n\r\n        self_cw._addEventToTabsOptions();\r\n        self_cw._addEventToLayerQuery();\r\n        self_cw._getDataByTipoPersona();\r\n        self_cw._getDataByDepartamento()\r\n        this.busyIndicator.hide();\r\n    },\r\n    onOpen() {\r\n        console.log('Consulta_wgt::onOpen');\r\n    },\r\n\r\n    _cleanMap() {\r\n        this.busyIndicator.show()\r\n            // this.map.graphics.clear();\r\n        let whereDefinition = '1=1'\r\n        lyr_dc = this.layersMap.getLayerInfoById(this.config.layer_id_dc);\r\n        lyr_dm = this.layersMap.getLayerInfoById(this.config.layer_id_dm);\r\n        lyr_dc.hide();\r\n        lyr_dm.hide();\r\n        lyr_dc.setFilter(whereDefinition);\r\n        lyr_dm.setFilter(whereDefinition);\r\n        this.busyIndicator.hide()\r\n        this.container_resultados_opcion_cw.classList.remove('active');\r\n        this.ap_none_resultados_opcion_cw.hidden = false;\r\n        this.controller_layer_query = false;\r\n    },\r\n\r\n    onClose() {\r\n        console.log('Consulta_wgt::onClose');\r\n        if (this.controller_layer_query) {\r\n            this._showMessage(this.nls.clean_map_question, type = 'question')\r\n        }\r\n    },\r\n    // onMinimize(){\r\n    //   console.log('Consulta_wgt::onMinimize');\r\n    // },\r\n    // onMaximize(){\r\n    //   console.log('Consulta_wgt::onMaximize');\r\n    // },\r\n    // onSignIn(credential){\r\n    //   console.log('Consulta_wgt::onSignIn', credential);\r\n    // },\r\n    // onSignOut(){\r\n    //   console.log('Consulta_wgt::onSignOut');\r\n    // }\r\n    // onPositionChange(){\r\n    //   console.log('Consulta_wgt::onPositionChange');\r\n    // },\r\n    // resize(){\r\n    //   console.log('Consulta_wgt::resize');\r\n    // }\r\n\r\n    _queryDcGeneral() {\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        // var feature_dc = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc);\r\n        self_cw.feature_dc.hide();\r\n        self_cw.feature_dc.setFilter('');\r\n        self_cw.feature_dc_table.getLayerObject().then(\r\n                function(response) {\r\n                    response.queryCount(query, function(results) {\r\n                        self_cw.numero_registros = results\r\n                        self_cw.ap_indicador_resultados_cw.innerText = results;\r\n                        self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n                        self_cw._generatePages();\r\n                        self_cw._queryDcByPage();\r\n                    }, function(error) {\r\n                        self_cw._showMessage(error.message, type = 'error')\r\n                    })\r\n                })\r\n            .catch((error) => {\r\n                self_cw._showMessage(error.message, type = 'error')\r\n                self_cw.busyIndicator_lw.hide();\r\n            });\r\n    },\r\n\r\n    queryDmGeneral() {\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        self_cw.feature_dm.hide();\r\n        self_cw.feature_dm.setFilter('');\r\n        self_cw.feature_dm.getLayerObject()\r\n            .then(\r\n                function(response) {\r\n                    response.queryIds(query, function(results) {\r\n                        // console.log(results);\r\n                        self_cw.numero_registros = results.length\r\n                        self_cw.ap_indicador_resultados_cw.innerText = results.length;\r\n                        self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n                        self_cw._generatePages();\r\n                        self_cw._queryDmByPage();\r\n                        // self_cw.busyIndicator.hide();\r\n                    }, function(error) {\r\n                        self_cw._showMessage(error.message, type = 'error')\r\n                    })\r\n                })\r\n            .catch((error) => {\r\n                self_cw._showMessage(error.message, type = 'error')\r\n                self_cw.busyIndicator_lw.hide();\r\n            });\r\n    },\r\n\r\n    _queryDcByPage(n = 1) {\r\n        // self_cw.feature_dc_sys.hide();\r\n        self_cw.busyIndicator.show();\r\n\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.busyIndicator.hide();\r\n            self_cw.ap_titulo_registros_resultados_cw.innerText = '';\r\n            self_cw.ap_resultados_cw.click();\r\n            return;\r\n        };\r\n\r\n        let query = new Query();\r\n        query.returnGeometry = false;\r\n        query.where = self_cw.whereDefinition;\r\n        query.num = self_cw.registros_pagina;\r\n        query.start = n == 1 ? 0 : (n - 1) * self_cw.registros_pagina;\r\n        query.orderByFields = [self_cw.field_id];\r\n\r\n        var start = query.start + 1\r\n        var fin = query.start + query.num > self_cw.numero_registros ? self_cw.numero_registros : self_cw.pagina_actual * query.num\r\n        self_cw.ap_titulo_registros_resultados_cw.innerText = String(start) + ' - ' + String(fin)\r\n\r\n        self_cw.feature_dc.hide();\r\n        self_cw.feature_dc.setFilter('');\r\n\r\n        // Realizando el query a la capa\r\n        self_cw.feature_dc_table.layerObject.queryFeatures(query, function(result) {\r\n            var rowcount = result.features.length;\r\n            if (rowcount) {\r\n                self_cw.controller_layer_query = true;\r\n            }\r\n            // self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n            // self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n            var data = result.features.map((i) => i.attributes);\r\n\r\n            let ids = data.map((i) => i[self_cw.field_id])\r\n            let ids_join = ids.join(', ')\r\n            let query_ids = self_cw.field_id + ' IN (' + ids_join + ')'\r\n\r\n\r\n            self_cw.feature_dc.setFilter(query_ids);\r\n            self_cw.feature_dc.show();\r\n\r\n            // self_cw.feature_dc_sys.setFilter(query_ids);\r\n            // self_cw.feature_dc_sys.show();\r\n\r\n            self_cw._populateResultsDC(data, start)\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n        self_cw.feature_dc.layerObject.queryExtent(query, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        });\r\n\r\n        if (self_cw.numero_paginas <= 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n            return;\r\n        }\r\n\r\n        if (n == 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        } else if (n == self_cw.numero_paginas) {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n        } else {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        }\r\n\r\n    },\r\n\r\n    _queryDmByPage(n = 1) {\r\n        // self_cw.feature_dc_sys.hide();\r\n        self_cw.busyIndicator.show();\r\n\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.busyIndicator.hide();\r\n            self_cw.ap_titulo_registros_resultados_cw.innerText = '';\r\n            self_cw.ap_resultados_cw.click();\r\n            return;\r\n        };\r\n\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        query.returnGeometry = false;\r\n        query.num = self_cw.registros_pagina;\r\n        query.start = n == 1 ? 0 : (n - 1) * self_cw.registros_pagina;\r\n        query.orderByFields = [self_cw.field_codigou_dm];\r\n\r\n        var start = query.start + 1\r\n        var fin = query.start + query.num > self_cw.numero_registros ? self_cw.numero_registros : self_cw.pagina_actual * query.num\r\n        self_cw.ap_titulo_registros_resultados_cw.innerText = String(start) + ' - ' + String(fin)\r\n\r\n        self_cw.feature_dm.hide();\r\n        self_cw.feature_dm.setFilter('');\r\n\r\n        // Realizando el query a la capa\r\n        self_cw.feature_dm.layerObject.queryFeatures(query, function(result) {\r\n            let rowcount = result.features.length;\r\n            if (rowcount) {\r\n                self_cw.controller_layer_query = true;\r\n            }\r\n\r\n            let data = result.features.map((i) => i.attributes);\r\n\r\n            let ids = data.map((i) => i[self_cw.field_codigou_dm])\r\n            let ids_join = ids.join(\"', '\")\r\n            let query_ids = self_cw.field_codigou_dm + \" IN ('\" + ids_join + \"')\"\r\n\r\n\r\n            self_cw.feature_dm.setFilter(query_ids);\r\n            self_cw.feature_dm.show();\r\n\r\n            self_cw._populateResultsDM(data, start);\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n        self_cw.feature_dm.layerObject.queryExtent(query, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        });\r\n\r\n        if (self_cw.numero_paginas <= 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n            return;\r\n        }\r\n\r\n        if (n == 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        } else if (n == self_cw.numero_paginas) {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n        } else {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        }\r\n    },\r\n\r\n    _queryDcByPageEvent(evt) {\r\n        // Obtiene el numero de la pagina\r\n        let page = evt.target.innerText;\r\n\r\n        self_cw.pagina_actual = parseInt(page);\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n\r\n        // Filtro de elementos\r\n        self_cw._queryDcByPage(self_cw.pagina_actual);\r\n\r\n        // Remover la pagina anterior seleccionada\r\n        dojo.query('.is-current').toggleClass('is-current');\r\n\r\n        // Activar la pagina actual seleccionada\r\n        evt.target.classList.toggle('is-current')\r\n    },\r\n\r\n    _queryDmByPageEvent(evt) {\r\n        // Obtiene el numero de la pagina\r\n        let page = evt.target.innerText;\r\n\r\n        self_cw.pagina_actual = parseInt(page);\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n\r\n        // Filtro de elementos\r\n        self_cw._queryDmByPage(self_cw.pagina_actual);\r\n\r\n        // Remover la pagina anterior seleccionada\r\n        dojo.query('.is-current').toggleClass('is-current');\r\n\r\n        // Activar la pagina actual seleccionada\r\n        evt.target.classList.toggle('is-current')\r\n    },\r\n\r\n    _nextPage(evt) {\r\n        self_cw.pagina_actual = self_cw.pagina_actual == self_cw.numero_paginas ? self_cw.pagina_actual : self_cw.pagina_actual + 1;\r\n\r\n        if (!self_cw.grupos_paginas[self_cw.grupo_actual].includes(self_cw.pagina_actual)) {\r\n            self_cw.grupo_actual = self_cw.grupo_actual == self_cw.grupos_paginas.length - 1 ? self_cw.grupo_actual : self_cw.grupo_actual + 1;\r\n            self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual)\r\n        }\r\n        dojo.query(`#page_${self_cw.pagina_actual}_cw`)[0].click();\r\n    },\r\n\r\n    _backPage(evt) {\r\n        self_cw.pagina_actual = self_cw.pagina_actual == 1 ? self_cw.pagina_actual : self_cw.pagina_actual - 1;\r\n        if (!self_cw.grupos_paginas[self_cw.grupo_actual].includes(self_cw.pagina_actual)) {\r\n            self_cw.grupo_actual = self_cw.grupo_actual == 0 ? self_cw.grupo_actual : self_cw.grupo_actual - 1;\r\n            self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual)\r\n        }\r\n        dojo.query(`#page_${self_cw.pagina_actual}_cw`)[0].click();\r\n    },\r\n\r\n    _generatePages() {\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.ap_pagination_cw.classList.remove('paginationActive');\r\n            self_cw.ap_pagination_list_cw.innerHTML = '';\r\n            self_cw.busyIndicator.hide();\r\n            return\r\n        }\r\n        if (!self_cw.ap_pagination_cw.classList.contains('paginationActive')) {\r\n            self_cw.ap_pagination_cw.classList.add('paginationActive');\r\n        }\r\n        self_cw.numero_paginas = Math.ceil(self_cw.numero_registros / self_cw.registros_pagina);\r\n        self_cw.grupos_paginas = self_cw._generateGroupsPages(self_cw.numero_paginas, self_cw.factor);\r\n        self_cw.grupo_actual = 0 // Es el primer grupo\r\n        self_cw.pagina_actual = 1 // Segundo parametro es 1 porque es la primera pagina\r\n\r\n        self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual);\r\n    },\r\n\r\n    _generateGroupsPages(numero_paginas, factor) {\r\n        let paginas = Array.from(Array(numero_paginas + 1).keys()).slice(1);\r\n        let grupos = Math.ceil(numero_paginas / factor);\r\n        var grupos_array = Array.from(Array(grupos).keys());\r\n        let grupos_paginas = grupos_array.map((i) => paginas.slice(i * factor, (i + 1) * factor));\r\n        return grupos_paginas;\r\n    },\r\n\r\n    _generatePagesFromArray(pages, val) {\r\n        let pages_html_array = [];\r\n        pages.forEach(function(n) {\r\n            let class_element = n == val ? 'pagination-link is-current pages_result_cw' : 'pagination-link pages_result_cw'\r\n            pages_html_array.push(`<li><a id=\"page_${n}_cw\" class=\"${class_element}\" aria-label=\"Pagina ${n}\">${n}</a></li>`)\r\n        });\r\n\r\n        if (self_cw.grupo_actual == 0 && self_cw.grupos_paginas.length == 1) {\r\n            // No hace nada\r\n        } else if (self_cw.grupo_actual == 0 && self_cw.grupos_paginas.length > 1) {\r\n            pages_html_array.push('<li><span class=\"pagination-ellipsis\">&hellip;</span></li>')\r\n        } else if (self_cw.grupo_actual == self_cw.grupos_paginas.length - 1) {\r\n            pages_html_array.splice(0, 0, '<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n        } else {\r\n            pages_html_array.push('<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n            pages_html_array.splice(0, 0, '<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n        }\r\n\r\n        pages_html = pages_html_array.join('');\r\n        self_cw.ap_pagination_list_cw.innerHTML = pages_html;\r\n\r\n        if (self_cw.controller_query == 'dc') {\r\n            dojo.query('.pages_result_cw').on('click', self_cw._queryDcByPageEvent);\r\n        } else if (self_cw.controller_query == 'dm') {\r\n            dojo.query('.pages_result_cw').on('click', self_cw._queryDmByPageEvent);\r\n        }\r\n    },\r\n\r\n    _applyQueryDC2() {\r\n        self_cw.feature_dm.hide();\r\n        let whereDefinitionArray = [];\r\n        self_cw.whereDefinition = '';\r\n\r\n        let ruc_dc = `(${self_cw.field_m_ruc} is not null)`;\r\n\r\n        if (self_cw.input_ruc_dc_cw.value != '') {\r\n            ruc_dc = `(${self_cw.field_m_ruc} like '%${self_cw.input_ruc_dc_cw.value}%' and ${ruc_dc})`;\r\n        }\r\n\r\n        whereDefinitionArray.push(ruc_dc);\r\n\r\n        let nombre_dc = `(lower(${self_cw.field_minero_informal}) like lower('%${self_cw.input_nombre_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombre_dc);\r\n\r\n        if (self_cw.select_tipo_persona_cw.value != '') {\r\n            let tipo_persona_dc = `(${self_cw.field_tipo_persona} like '%${self_cw.select_tipo_persona_cw.value}%')`;\r\n            whereDefinitionArray.push(tipo_persona_dc);\r\n        };\r\n\r\n        let codigou_dc = `(upper(${self_cw.field_id_unidad}) like upper('%${self_cw.input_codigou_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dc);\r\n\r\n        let nombredm_dc = `(lower(${self_cw.field_derecho_minero}) like lower('%${self_cw.input_nombre_dm_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dc);\r\n\r\n        let ubigeo_dc = `(${self_cw.field_id_ubigeo_inei} like '${self_cw.controller_ubigeo}%')`;\r\n        whereDefinitionArray.push(ubigeo_dc);\r\n\r\n        self_cw.whereDefinition = whereDefinitionArray.join(' and ');\r\n        self_cw._queryDcGeneral();\r\n    },\r\n\r\n    _applyQueryDM2() {\r\n        self_cw.feature_dc.hide();\r\n        let whereDefinitionArray = []\r\n        self_cw.whereDefinition = ''\r\n\r\n        var codigou_dm = `(upper(${self_cw.field_codigou_dm}) like upper('%${self_cw.input_codigou_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dm)\r\n\r\n        var nombredm_dm = `(lower(${self_cw.field_concesion_dm}) like lower('%${self_cw.input_nombre_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dm)\r\n\r\n        self_cw.whereDefinition = whereDefinitionArray.join(' and ');\r\n\r\n        self_cw.queryDmGeneral();\r\n    },\r\n});"]}