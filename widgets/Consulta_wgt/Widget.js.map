{"version":3,"sources":["../../../widgets/Consulta_wgt/Widget.js"],"names":["declare","_WidgetsInTemplateMixin","BaseWidget","lang","LayerInfos","Query","QueryTask","StatisticDefinition","FeatureLayer","GraphicsLayer","Graphic","SimpleFillSymbol","SimpleLineSymbol","SimpleMarkerSymbol","Color","Message","BusyIndicator","baseClass","iniClause","layersMap","field_dep_nm_depa","field_dep_cd_depa","field_prov_nm_prov","field_prov_cd_prov","field_dist_nm_dist","field_dist_cd_dist","field_codigou_dm","field_concesion_dm","field_sustancia_dm","field_id","field_minero_informal","field_m_ruc","field_derecho_minero","field_id_unidad","field_tipo_persona","field_id_ubigeo_inei","controller_query","controller_layer_query","controller_ubigeo","temporal_class_results","feature_dc","feature_dm","numero_registros","numero_paginas","registros_pagina","pagina_actual","grupo_actual","grupos_paginas","factor","whereDefinition","postCreate","self_cw","inherited","arguments","_getAllLayers","getLayerInfoById","config","layer_id_dc","layer_id_dm","feature_dep","layer_id_dep","feature_prov","layer_id_prov","feature_dist","layer_id_dist","getInstance","map","itemInfo","then","hitch","layerInfosObj","_showMessage","message","type","messagebox","titleLabel","nls","_widgetLabel","buttons","label","onClick","close","_cleanMap","_getDataByTipoPersona","id","query","where","returnGeometry","returnDistinctValues","outFields","layerObject","queryFeatures","results","features","length","forEach","opt","document","createElement","value","i","attributes","text","select_tipo_persona_cw","add","selected","error_tipo_persona_count","error","error_tipo_persona","_getDataByDepartamento","queryTask","getUrl","orderByFields","execute","departamento_cw","error_departamento_count","error_departamento","_getDataByProvincia","evt","busyIndicator","show","cd_depa","target","distrito_cw","innerHTML","container_distrito_cw","classList","remove","container_provincia_cw","hide","contains","toggle","_zoomExtendSelected","fragment","createDocumentFragment","provincia_cw","appendChild","error_provincia_count","error_provincia","_getDataByDistrito","cd_prov","substring","error_distrito_count","error_distrito","_getDistritoSelected","cd_dist","_addEventToLayerQuery","dojo","on","_setFormContainer","title","currentTarget","innerText","titulo_consulta","ListaCapasConsulta","hidden","nodeContainer_cw","toggleClass","node","dataset","dojoAttachPoint","includes","_returnListaCapasConsulta","_addEventToTabsOptions","_connectTabsWithOptionContainer","option","toLowerCase","container_option","_validateRucNumber","val","replace","_openPopupAutocamitcally","featureInfo","center","infoWindow","setFeatures","getInfoWindowAnchor","centerAt","_openPopupAutocamitcally2","featureLayer","_zoomDmExtentToMap","id_layer","feature","setFilter","getLayerObject","response","symbol","STYLE_NULL","STYLE_SOLID","ext","geometry","getExtent","getCentroid","setExtent","none_element","none_reference_map","error_query_feature","error_service","queryExtent","res","count","extent","_applyQuery","ap_registros_encontrados_cw","_applyQueryDC2","_applyQueryDM2","_cloneNode","clone","nodeType","createTextNode","nodeValue","cloneNode","child","firstChild","nextSibling","_rowNode","parser","DOMParser","doc","parseFromString","body","childNodes","_populateResultsDC","arrayResults","enumerate_ini","r","newRow","style","display","getElementsByClassName","fieldsList","push","field_dc_ruc","field_nombre_dm","fieldsListNode","join","_showPopupRowSelectedClick","_showReinfos","parentElement","getAttribute","elm","removeChild","rownum","show_reinfos","data","lidata","index","lidataString","ulnode","create","addClass","none_element_pl","_populateResultsDM","_showPopupRowSelectedClickDM","id_row","selectFeatures","SELECTION_NEW","error_none_geometry","catch","expand","startup","console","log","domNode","parentNode","backgroundOpacity","onOpen","lyr_dc","lyr_dm","container_resultados_opcion_cw","ap_none_resultados_opcion_cw","onClose","clean_map_question","_queryDcGeneral","queryCount","ap_indicador_resultados_cw","ap_titulo_resultados_cw","_generatePages","_queryDcByPage","busyIndicator_lw","queryDmGeneral","queryIds","_queryDmByPage","n","ap_titulo_registros_resultados_cw","ap_resultados_cw","click","num","start","fin","String","result","rowcount","ids","ids_join","query_ids","class_list_container_resultados","ap_anterior_page_cw","setAttribute","ap_siguiente_page_cw","removeAttribute","_queryDcByPageEvent","page","parseInt","_queryDmByPageEvent","_nextPage","_generatePagesFromArray","_backPage","ap_pagination_cw","ap_pagination_list_cw","Math","ceil","_generateGroupsPages","paginas","Array","from","keys","slice","grupos","grupos_array","pages","pages_html_array","class_element","splice","pages_html","whereDefinitionArray","ruc_dc","input_ruc_dc_cw","nombre_dc","input_nombre_dc_cw","tipo_persona_dc","codigou_dc","input_codigou_dc_cw","nombredm_dc","input_nombre_dm_dc_cw","ubigeo_dc","codigou_dm","input_codigou_dm_cw","nombredm_dm","input_nombre_dm_cw"],"mappings":"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","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\n// import query from \"dojo/query\";\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport StatisticDefinition from \"esri/tasks/StatisticDefinition\";\r\n// import InfoTemplate from \"esri/InfoTemplate\";\r\nimport FeatureLayer from \"esri/layers/FeatureLayer\";\r\n\r\nimport GraphicsLayer from \"esri/layers/GraphicsLayer\";\r\nimport Graphic from 'esri/graphic';\r\n\r\nimport SimpleFillSymbol from \"esri/symbols/SimpleFillSymbol\";\r\nimport SimpleLineSymbol from 'esri/symbols/SimpleLineSymbol';\r\nimport SimpleMarkerSymbol from 'esri/symbols/SimpleMarkerSymbol';\r\nimport Color from 'dojo/_base/Color';\r\n\r\nimport Message from \"jimu/dijit/Message\";\r\n// import 'jimu/dijit/LoadingIndicator';\r\n// import 'jimu/dijit/LoadingShelter'\r\nimport BusyIndicator from 'esri/dijit/util/busyIndicator';\r\n// import domConstruct from 'dojo/dom-construct';\r\n// import on from 'dojo/on';\r\n// import domClass from \"dojo/dom-class\";\r\n// import \"dojo/domReady!\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([BaseWidget, _WidgetsInTemplateMixin, Query,\r\n    QueryTask,\r\n    StatisticDefinition,\r\n    // FeatureLayer\r\n], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'consulta-wgt',\r\n    iniClause: '1=1',\r\n\r\n    layersMap: [],\r\n\r\n    field_dep_nm_depa: 'NM_DEPA',\r\n    field_dep_cd_depa: 'CD_DEPA',\r\n\r\n    field_prov_nm_prov: 'NM_PROV',\r\n    field_prov_cd_prov: 'CD_PROV',\r\n\r\n    field_dist_nm_dist: 'NM_DIST',\r\n    field_dist_cd_dist: 'CD_DIST',\r\n\r\n\r\n    // // Campos DM Ingemmet\r\n    // field_codigou_dm: 'CODIGOU',\r\n    // field_concesion_dm: 'CONCESION',\r\n    // field_sustancia_dm: 'SUSTANCIA',\r\n\r\n    //  Campos DM Minem\r\n    field_codigou_dm: 'ID_UNIDAD',\r\n    field_concesion_dm: 'NOMBRE',\r\n    field_sustancia_dm: 'ID_CLASE_SUSTANCIA',\r\n\r\n    // Campos DC\r\n    field_id: 'ID', // Objectid del minero informal\r\n    field_minero_informal: 'MINERO_INFORMAL', // Nombre del minero informal\r\n    field_m_ruc: 'M_RUC', // RUC del minero informal\r\n    field_derecho_minero: 'DERECHO_MINERO', // Nombre del derecho mineroo\r\n    field_id_unidad: 'ID_UNIDAD', // Identificador del derecho minero (CODIGOU)\r\n    field_tipo_persona: 'TIPO_PERSONA', // Tipo de persona (natural, juridica)\r\n    field_id_ubigeo_inei: 'ID_UBIGEO_INEI', // Ubigeo\r\n\r\n    controller_query: '', // Permite identificar la opcion de consulta seleccionada\r\n    controller_layer_query: false,\r\n\r\n    controller_ubigeo: '',\r\n\r\n    temporal_class_results: '',\r\n\r\n    feature_dc: null,\r\n    feature_dm: null,\r\n\r\n    numero_registros: 0,\r\n    numero_paginas: 0,\r\n    registros_pagina: 1000,\r\n    pagina_actual: 1,\r\n    grupo_actual: 0,\r\n    grupos_paginas: [],\r\n    factor: 4,\r\n    whereDefinition: '',\r\n\r\n    // add additional properties here\r\n\r\n    // methods to communication with app container:\r\n    postCreate() {\r\n        self_cw = this;\r\n        this.inherited(arguments);\r\n        // console.log('Consulta_wgt::postCreate');;\r\n        this._getAllLayers();\r\n        this.feature_dc = this.layersMap.getLayerInfoById(this.config.layer_id_dc);\r\n        this.feature_dm = this.layersMap.getLayerInfoById(this.config.layer_id_dm);\r\n        this.feature_dep = this.layersMap.getLayerInfoById(this.config.layer_id_dep);\r\n        this.feature_prov = this.layersMap.getLayerInfoById(this.config.layer_id_prov);\r\n        this.feature_dist = this.layersMap.getLayerInfoById(this.config.layer_id_dist);\r\n\r\n    },\r\n\r\n    _getAllLayers() {\r\n        LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n            .then(lang.hitch(this, function(layerInfosObj) {\r\n                this.layersMap = layerInfosObj;\r\n            }));\r\n    },\r\n\r\n    _showMessage(message, type = 'message') {\r\n        switch (type) {\r\n            case 'question':\r\n                let messagebox = new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                    buttons: [{\r\n                        label: 'SI',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            messagebox.close();\r\n                        }))\r\n                    }, {\r\n                        label: 'NO',\r\n                        onClick: lang.hitch(this, lang.hitch(this, function() {\r\n                            this._cleanMap();\r\n                            messagebox.close();\r\n                        }))\r\n                    }]\r\n                });\r\n\r\n                break;\r\n            default:\r\n                new Message({\r\n                    type: type,\r\n                    titleLabel: `Widget ${this.nls._widgetLabel}: ${type}`,\r\n                    message: message,\r\n                });\r\n                break;\r\n        }\r\n\r\n    },\r\n\r\n    // Metodos para agregar opciones a las etiquetas 'select'\r\n    _getDataByTipoPersona() {\r\n        let id = this.config.layer_id_dc\r\n            // let feature_dc = this.layersMap.getLayerInfoById(id);\r\n        let query = new Query();\r\n        query.where = `${this.field_tipo_persona} IS NOT NULL`;\r\n        query.returnGeometry = false;\r\n        query.returnDistinctValues = true;\r\n        query.outFields = [this.field_tipo_persona];\r\n\r\n        self_cw.feature_dc.layerObject.queryFeatures(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_tipo_persona];\r\n                    opt.text = i.attributes[self_cw.field_tipo_persona];\r\n                    self_cw.select_tipo_persona_cw.add(opt);\r\n                });\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.select_tipo_persona_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_tipo_persona_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_tipo_persona}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n    _getDataByDepartamento() {\r\n        let id = this.config.layer_id_dep\r\n        let feature_dep = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dep.getUrl());\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} <> 99`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dep_nm_depa, this.field_dep_cd_depa];\r\n        query.orderByFields = [this.field_dep_nm_depa];\r\n        queryTask.execute(query, function(results) {\r\n            let features = results.features;\r\n            if (features.length) {\r\n                results.features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dep_cd_depa];\r\n                    opt.text = i.attributes[self_cw.field_dep_nm_depa];\r\n                    self_cw.departamento_cw.add(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                self_cw.departamento_cw.add(opt);\r\n            } else {\r\n                self_cw._showMessage(self_cw.nls.error_departamento_count)\r\n            }\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_departamento}\\n${error.message}`, type = 'error')\r\n        })\r\n    },\r\n\r\n\r\n    _getDataByProvincia(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona un departamento\r\n        // Carga las provincias pertenecientes al departamento seleccionado\r\n        // Realiza el zoom en el mapa al departamento seleccionado\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_depa = evt.target.value;\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_depa;\r\n\r\n        this.distrito_cw.innerHTML = '';\r\n        this.container_distrito_cw.classList.remove('active');\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de departamentos\r\n        if (cd_depa == '') {\r\n            // Removemos el combo de provincias\r\n            this.container_provincia_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            // Salimos del evento\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de provincias no esta activo\r\n        if (!this.container_provincia_cw.classList.contains('active')) {\r\n            // Activar el contenedor de provincias\r\n            this.container_provincia_cw.classList.toggle('active');\r\n        };\r\n\r\n        // Obteniendo el LayerObject de provincias\r\n        let id = this.config.layer_id_prov\r\n        let feature_prov = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_prov.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener las provincias del departamento\r\n        let query = new Query();\r\n        query.where = `${this.field_dep_cd_depa} = '${cd_depa}'`;\r\n\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_prov_nm_prov, this.field_prov_cd_prov];\r\n        query.orderByFields = [this.field_prov_nm_prov];\r\n\r\n        self_cw._zoomExtendSelected(self_cw.feature_dep, query.where);\r\n\r\n        // Ejecucion de consulta para obtener las opciones de provincias\r\n        queryTask.execute(query, function(results) {\r\n            let fragment = document.createDocumentFragment();\r\n            // Zoom al departamento seleccionado\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                self_cw.provincia_cw.innerHTML = '';\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_prov_cd_prov];\r\n                    opt.text = i.attributes[self_cw.field_prov_nm_prov];\r\n                    // self_cw.provincia_cw.add(opt);\r\n                    fragment.appendChild(opt);\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                fragment.appendChild(opt);\r\n                // self_cw.provincia_cw.add(opt);\r\n                self_cw.provincia_cw.appendChild(fragment);\r\n\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_provincia_count}`)\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_provincia}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n    },\r\n\r\n    _getDataByDistrito(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una provincia\r\n        // Carga las provincias pertenecientes a la provincia seleccionada\r\n        // Realiza el zoom en el mapa a la provincia seleccionada\r\n\r\n        // habilitar loader\r\n        this.busyIndicator.show();\r\n\r\n        // Obteniendo datos de la opcion seleccionada\r\n        let cd_prov = evt.target.value;\r\n\r\n        // Si se selecciono la opcion 'Todos' en el elemento 'Select' de provincias\r\n        if (cd_prov == '') {\r\n            // Anulamos los dos ultimos digitos del controlador de ubigeo\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 2);\r\n            // Ocultamos el selector de distritos\r\n            this.container_distrito_cw.classList.remove('active');\r\n            // deshabilitar loader\r\n            this.busyIndicator.hide();\r\n            return\r\n        }\r\n\r\n        // Si el contenedor de distrito no esta activo\r\n        if (!this.container_distrito_cw.classList.contains('active')) {\r\n            // Activar el contenedor de distrito\r\n            this.container_distrito_cw.classList.toggle('active');\r\n        }\r\n\r\n        // Capturando el codigo de la provincia en el controlador de ubigeo\r\n        this.controller_ubigeo = cd_prov;\r\n\r\n        // Obteniendo el LayerObject de distritos\r\n        let id = this.config.layer_id_dist;\r\n        let feature_dist = this.layersMap.getLayerInfoById(id);\r\n        let queryTask = new QueryTask(feature_dist.getUrl());\r\n\r\n        // Definiendo el objeto Query para obtener los distritos de la provincia\r\n        let query = new Query();\r\n        query.where = `${this.field_prov_cd_prov} = '${cd_prov}'`;\r\n        query.returnGeometry = false;\r\n        query.outFields = [this.field_dist_nm_dist, this.field_dist_cd_dist];\r\n        query.orderByFields = [this.field_dist_nm_dist];\r\n\r\n        self_cw._zoomExtendSelected(self_cw.feature_prov, query.where);\r\n\r\n        // Ejecucion de consulta para obtener las opciones de distritos\r\n        queryTask.execute(query, function(results) {\r\n            let fragment = document.createDocumentFragment();\r\n            // Zoom a la provincia seleccionada\r\n            // self_cw._zoomExtendSelected(self_cw.config.layer_id_prov, query.where);\r\n            self_cw.distrito_cw.innerHTML = \"\";\r\n            let features = results.features;\r\n            // Si se encontraron resultados\r\n            if (features.length) {\r\n                features.forEach(i => {\r\n                    let opt = document.createElement(\"option\");\r\n                    opt.value = i.attributes[self_cw.field_dist_cd_dist];\r\n                    opt.text = i.attributes[self_cw.field_dist_nm_dist];\r\n                    // self_cw.distrito_cw.add(opt);\r\n                    fragment.appendChild(opt)\r\n                })\r\n                let opt = document.createElement(\"option\");\r\n                opt.value = '';\r\n                opt.text = 'Todos';\r\n                opt.selected = true;\r\n                // self_cw.distrito_cw.add(opt);\r\n                fragment.appendChild(opt);\r\n                self_cw.distrito_cw.appendChild(fragment)\r\n            } else {\r\n                // Notificar si no se encontraron elementos\r\n                self_cw._showMessage(`${self_cw.nls.error_distrito_count}`);\r\n            };\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        }, function(error) {\r\n            // Notificar si ocurrio algun error al momento de solicitar los datos\r\n            self_cw._showMessage(`${self_cw.nls.error_distrito}\\n${error.message}`, type = 'error');\r\n            // deshabilitar loader\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n    },\r\n\r\n    _getDistritoSelected(evt) {\r\n        // Evento que se ejecuta cuando el usuario selecciona una distrito\r\n        // Realiza el zoom en el mapa al distrito seleccionado\r\n        var cd_dist = evt.target.value;\r\n        whereDefinition = `${this.field_dist_cd_dist} = '${cd_dist}'`\r\n        if (cd_dist == '') {\r\n            this.controller_ubigeo = this.controller_ubigeo.substring(0, 4)\r\n            return\r\n        }\r\n        this.controller_ubigeo = cd_dist;\r\n        this._zoomExtendSelected(this.feature_dist, whereDefinition);\r\n        // this._zoomExtendSelected(this.config.layer_id_dist, whereDefinition);\r\n    },\r\n\r\n    // Metodos dedicados al frontend del widget\r\n\r\n    _addEventToLayerQuery() {\r\n        dojo.query(\".capa_consulta_cw\").on('click', this._setFormContainer);\r\n    },\r\n\r\n    _setFormContainer(evt) {\r\n        var title = evt.currentTarget.innerText;\r\n\r\n        self_cw.controller_query = evt.currentTarget.id;\r\n        self_cw.titulo_consulta.innerText = title\r\n        self_cw.ListaCapasConsulta.hidden = true;\r\n\r\n        var nodeContainer_cw = dojo.query(\".container_cw\")\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active')\r\n        dojo.query('.formulario_cw').forEach(function(node) {\r\n            if (node.dataset.dojoAttachPoint.includes(self_cw.controller_query)) {\r\n                node.hidden = false;\r\n            } else {\r\n                node.hidden = true;\r\n            }\r\n        })\r\n    },\r\n\r\n    _returnListaCapasConsulta() {\r\n        var nodeContainer_cw = dojo.query(\".container_cw\");\r\n        dojo.toggleClass(nodeContainer_cw[0], 'active');\r\n        this.ListaCapasConsulta.hidden = false;\r\n    },\r\n\r\n    _addEventToTabsOptions() {\r\n        dojo.query('.opcion_cw').on('click', this._connectTabsWithOptionContainer)\r\n    },\r\n\r\n    _connectTabsWithOptionContainer(evt) {\r\n        var option = evt.currentTarget.innerText.toLowerCase();\r\n        if (evt.currentTarget.classList.contains('is-active')) {\r\n            return\r\n        };\r\n        dojo.query('.opcion_cw').forEach(function(node) {\r\n            var container_option = self_cw[`${node.id}_${node.classList[0]}`]\r\n            if (node.innerText.toLowerCase() == option) {\r\n                node.classList.toggle('is-active')\r\n                container_option.classList.toggle('active')\r\n            } else {\r\n                node.classList.remove('is-active');\r\n                container_option.classList.remove('active')\r\n            }\r\n        });\r\n    },\r\n\r\n    _validateRucNumber(evt) {\r\n        var val = evt.currentTarget.value;\r\n        evt.currentTarget.value = val.replace(/[^0-9.]/g, '').replace(/(\\..*)\\./g, '$1');\r\n    },\r\n\r\n    // Interaccion con el mapa\r\n\r\n    _openPopupAutocamitcally(featureInfo, center, whereDefinition) {\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n        featureInfo.layerObject.queryFeatures(query, function(results) {\r\n            self_cw.map.infoWindow.setFeatures(results.features);\r\n            self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n            self_cw.map.centerAt(center);\r\n\r\n            // self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        });\r\n\r\n    },\r\n\r\n    _openPopupAutocamitcally2(featureLayer, center) {\r\n        self_cw.map.infoWindow.setFeatures(featureLayer.features);\r\n        self_cw.map.infoWindow.show(center, self_cw.map.getInfoWindowAnchor(center));\r\n        self_cw.map.centerAt(center);\r\n    },\r\n\r\n    _zoomDmExtentToMap(evt) {\r\n\r\n        // self_cw._applyQueryDM.click()\r\n        let id = evt.currentTarget.innerText;\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${id}'`\r\n        let id_layer = self_cw.config.layer_id_dm;\r\n        let feature = self_cw.layersMap.getLayerInfoById(id_layer);\r\n        feature.setFilter(query.where);\r\n        feature.show();\r\n\r\n        feature.getLayerObject().then(function(response) {\r\n            // self_cw.map.graphics.clear();\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    let symbol = new SimpleFillSymbol(\r\n                        SimpleFillSymbol.STYLE_NULL,\r\n                        new SimpleLineSymbol(\r\n                            SimpleLineSymbol.STYLE_SOLID,\r\n                            new Color([255, 0, 0]), 3\r\n                        ),\r\n                        new Color([125, 125, 125, 0.35]));\r\n\r\n                    let ext = results.features[0].geometry.getExtent();\r\n                    let center = results.features[0].geometry.getCentroid();\r\n\r\n                    // let graphic = results.features[0].setSymbol(symbol)\r\n                    // self_cw.map.graphics.add(graphic);\r\n                    self_cw._openPopupAutocamitcally2(results, center);\r\n                    self_cw.map.setExtent(ext, true);\r\n\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${id}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        })\r\n    },\r\n\r\n    _zoomExtendSelected(feature, whereDefinition) {\r\n        let query = new Query();\r\n        query.where = whereDefinition;\r\n        // let feature = this.layersMap.getLayerInfoById(idService);\r\n        feature.getLayerObject().then(function(results) {\r\n            results.queryExtent(query, function(res) {\r\n                if (res.count) {\r\n                    self_cw.map.setExtent(res.extent, true)\r\n                } else {\r\n                    self_cw._showMessage(`${self_cw.nls.none_element} ${whereDefinition}, ${self_cw.nls.none_reference_map}`);\r\n                }\r\n\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error');\r\n        });\r\n    },\r\n\r\n    // Proceso que realiza la consulta\r\n    _applyQuery(evt) {\r\n        this.busyIndicator.show();\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n        switch (self_cw.controller_query) {\r\n            case 'dc':\r\n                // self_cw._applyQueryDC()\r\n                self_cw._applyQueryDC2();\r\n                break;\r\n            case 'dm':\r\n                // self_cw._applyQueryDM();\r\n                self_cw._applyQueryDM2()\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    _cloneNode(node) {\r\n        var clone = node.nodeType == 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\r\n        var child = node.firstChild;\r\n        while (child) {\r\n            clone.appendChild(self_cw._cloneNode(child));\r\n            child = child.nextSibling;\r\n        }\r\n        return clone;\r\n    },\r\n\r\n    _rowNode() {\r\n        let node = `<li style=\"display: none;\" data-dojo-attach-point=\"ap_template_registros_resultados_cw\">\r\n                        <a class=\"container_head_registros_cw\">\r\n                            <div class=\"columns is-mobile\">\r\n                                <div class=\"column is-four-fifths title_registros_cw\"></div>\r\n                                <div class=\"column has-text-right\"><span class=\"icon has-text-info\"><i class=\"fas fa-search\"></i></span></div>\r\n                            </div>\r\n                        </a>\r\n                        <ul class=\"detalle_registros_resultados_cw\">\r\n                        </ul>\r\n                    </li>`;\r\n        var parser = new DOMParser();\r\n        var doc = parser.parseFromString(node, 'text/html');\r\n        return doc.body.childNodes[0];\r\n    },\r\n\r\n    _populateResultsDC(arrayResults, enumerate_ini = 1) {\r\n        let fragment = document.createDocumentFragment();\r\n        arrayResults.forEach(function(r, i) {\r\n            let newRow = self_cw._rowNode();\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            // var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${enumerate_ini}. ${r[self_cw.field_minero_informal]}`;\r\n            newRow.getElementsByClassName('container_head_registros_cw')[0].id = r[self_cw.field_id];\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_dc_ruc}: ${r[self_cw.field_m_ruc]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_derecho_minero]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_codigou_dm}: <span class=\"tag is-primary codigou_cw\">${r[self_cw.field_id_unidad]}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            fragment.appendChild(newRow);\r\n            enumerate_ini = enumerate_ini + 1\r\n        });\r\n        self_cw.ap_registros_encontrados_cw.appendChild(fragment);\r\n        dojo.query('.container_head_registros_cw').on('click', self_cw._showPopupRowSelectedClick);\r\n        dojo.query('.codigou_cw').on('click', self_cw._zoomDmExtentToMap);\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showReinfos(evt) {\r\n        self_cw.busyIndicator.show();\r\n        let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        var elm = dojo.query(`.ul_registro_dc_${id}`);\r\n\r\n        if (evt.currentTarget.parentElement.classList.contains('active')) {\r\n            if (elm.length) {\r\n                evt.currentTarget.parentElement.removeChild(elm[0])\r\n                evt.currentTarget.parentElement.classList.toggle('active')\r\n            }\r\n            self_cw.busyIndicator.hide();\r\n            return;\r\n        }\r\n\r\n        // let id = evt.currentTarget.parentElement.getAttribute('value');\r\n        // let feature = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc)\r\n\r\n        // let feature_sys = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc_sys)\r\n\r\n        let query = new Query();\r\n        query.where = `(${self_cw.field_id_unidad} = '${id}') and (${self_cw.field_m_ruc} is not null)`;\r\n\r\n        self_cw.feature_dc.setFilter(query.where);\r\n        self_cw.feature_dc.show();\r\n\r\n        // feature_sys.setFilter(query.where);\r\n        // feature_sys.show();\r\n\r\n        // evt.currentTarget.parentElement.classList.toggle('active')\r\n\r\n        self_cw.feature_dc.getLayerObject().then(function(response) {\r\n            response.queryFeatures(query, function(results) {\r\n                if (results.features.length) {\r\n                    evt.target.parentElement.classList.toggle('active')\r\n                    let rownum = results.features.length;\r\n                    evt.target.innerText = `${self_cw.nls.show_reinfos} (${rownum})`\r\n                    let data = results.features.map((i) => i.attributes);\r\n                    let lidata = data.map((i, index) => `<li class=\"registro_dc\" id=\"${i[self_cw.field_id]}\"><a>${index + 1}. ${i[self_cw.field_m_ruc]} - ${i[self_cw.field_minero_informal]}</a></li>`)\r\n                    let lidataString = lidata.join('');\r\n                    let ulnode = dojo.create('ul');\r\n                    ulnode.innerHTML = lidataString;\r\n                    dojo.addClass(ulnode, `ul_registro_dc_${id}`)\r\n                    evt.target.parentElement.appendChild(ulnode);\r\n                    dojo.query('.registro_dc').on('click', self_cw._showPopupRowSelectedClick)\r\n                } else {\r\n                    evt.target.innerText = `${self_cw.nls.show_reinfos} (0)`\r\n                    self_cw._showMessage(self_cw.nls.none_element_pl);\r\n                };\r\n                self_cw.busyIndicator.hide();\r\n            }, function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${feature.title} (${query.where})\\n${error.message}`);\r\n                self_cw.busyIndicator.hide();\r\n            })\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_service} ${feature.title}\\n${error.message}`, type = 'error')\r\n            self_cw.busyIndicator.hide();\r\n        })\r\n    },\r\n\r\n    _populateResultsDM(arrayResults, enumerate_ini = 1) {\r\n        let fragment = document.createDocumentFragment();\r\n        arrayResults.forEach(function(r, i) {\r\n            // if (self_cw.temporal_class_results) {\r\n            //     var newRow = self_cw.temporal_class_results;\r\n            // } else {\r\n            //     var newRow = dojo.clone(self_cw.ap_template_registros_resultados_cw);\r\n            // }\r\n            let newRow = self_cw._rowNode();\r\n\r\n            newRow.style.display = 'block';\r\n\r\n            // var nodeTitle = dojo.query('.title_registros_cw', newRow)[0]\r\n            newRow.getElementsByClassName('title_registros_cw')[0].innerText = `${enumerate_ini}. ${self_cw.nls.field_codigou_dm}: ${r[self_cw.field_codigou_dm]}`;\r\n            // newRow.getElementsByClassName('title_registros_cw')[0].id = r[self_cw.field_codigou_dm];\r\n            newRow.getElementsByClassName('container_head_registros_cw')[0].id = r[self_cw.field_codigou_dm];\r\n            // dojo.connect(nodeTitle, 'onclick', self_cw._showPopupRowSelectedClickDM);\r\n\r\n            // Lista campos\r\n\r\n            var fieldsList = []\r\n            fieldsList.push(`<li>${self_cw.nls.field_nombre_dm}: ${r[self_cw.field_concesion_dm]}</li>`);\r\n            fieldsList.push(`<li>${self_cw.nls.field_sustancia_dm}: ${r[self_cw.field_sustancia_dm]}</li>`);\r\n            fieldsList.push(`<li value=\"${r[self_cw.field_codigou_dm]}\"><span class=\"tag is-primary reinfos_cw\">${self_cw.nls.show_reinfos}<span></li>`);\r\n\r\n            fieldsListNode = fieldsList.join('');\r\n\r\n            newRow.getElementsByClassName('detalle_registros_resultados_cw')[0].innerHTML = fieldsListNode;\r\n\r\n            fragment.appendChild(newRow);\r\n            enumerate_ini = enumerate_ini + 1;\r\n        })\r\n        self_cw.ap_registros_encontrados_cw.appendChild(fragment);\r\n        dojo.query('.container_head_registros_cw').on('click', self_cw._showPopupRowSelectedClickDM);\r\n        dojo.query('.reinfos_cw').on('click', self_cw._showReinfos);\r\n        this.busyIndicator.hide();\r\n    },\r\n\r\n    _showPopupRowSelectedClick(evt) {\r\n        let id_row = evt.currentTarget.id;\r\n\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_id} = ${id_row}`\r\n\r\n        self_cw.feature_dc.layerObject.selectFeatures(query, FeatureLayer.SELECTION_NEW)\r\n            .then(\r\n                function(response) {\r\n                    let center = response[0].geometry;\r\n                    if (!center) {\r\n                        self_cw._showMessage(self_cw.nls.error_none_geometry);\r\n                        return;\r\n                    }\r\n\r\n                    self_cw.map.infoWindow.setFeatures(response);\r\n                    self_cw.map.infoWindow.show(center);\r\n                    self_cw.map.centerAt(center);\r\n\r\n                },\r\n                function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dc.title} (${query.where})\\n${error.message}`);\r\n                })\r\n            .catch(function(error) {\r\n                self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dc.title}\\n${error.message}`);\r\n            })\r\n\r\n    },\r\n\r\n\r\n\r\n    _showPopupRowSelectedClickDM(evt) {\r\n        let id_row = evt.currentTarget.id;\r\n\r\n        let query = new Query();\r\n        query.where = `${self_cw.field_codigou_dm} = '${id_row}'`;\r\n        query.returnGeometry = true;\r\n        query.outFields = ['*'];\r\n\r\n        let queryTask = new QueryTask(self_cw.feature_dm.getUrl());\r\n        queryTask.execute(query, function(results) {\r\n            let center = results.features[0].geometry.getCentroid();\r\n            if (!center) {\r\n                self_cw._showMessage(self_cw.nls.error_none_geometry);\r\n                return;\r\n            };\r\n\r\n            self_cw.feature_dm.layerObject.selectFeatures(query, FeatureLayer.SELECTION_NEW).then(\r\n                function(response) {\r\n                    self_cw.map.infoWindow.setFeatures(response);\r\n                    self_cw.map.infoWindow.show(center);\r\n                    let ext = results.features[0].geometry.getExtent();\r\n                    self_cw.map.setExtent(ext.expand(1.6), true);\r\n                },\r\n                function(error) {\r\n                    self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dm.title} (${query.where})\\n${error.message}`);\r\n                }\r\n            );\r\n        }, function(error) {\r\n            self_cw._showMessage(`${self_cw.nls.error_query_feature} ${self_cw.feature_dm.title} (${query.where})\\n${error.message}`);\r\n        });\r\n    },\r\n\r\n    startup() {\r\n        this.inherited(arguments);\r\n        console.log('Consulta_wgt::startup');\r\n        this.busyIndicator = BusyIndicator.create({\r\n            target: this.domNode.parentNode.parentNode.parentNode,\r\n            backgroundOpacity: 0\r\n        });\r\n        this.busyIndicator.show();\r\n\r\n        // var panel = this.getPanel();\r\n        // var pos = panel.position;\r\n        // pos.width = 450;\r\n        // panel.setPosition(pos);\r\n        // panel.panelManager.normalizePanel(panel);\r\n\r\n\r\n        self_cw._addEventToTabsOptions();\r\n        self_cw._addEventToLayerQuery();\r\n        self_cw._getDataByTipoPersona();\r\n        self_cw._getDataByDepartamento()\r\n        this.busyIndicator.hide();\r\n    },\r\n    onOpen() {\r\n        console.log('Consulta_wgt::onOpen');\r\n    },\r\n\r\n    _cleanMap() {\r\n        this.busyIndicator.show()\r\n            // this.map.graphics.clear();\r\n        let whereDefinition = '1=1'\r\n        lyr_dc = this.layersMap.getLayerInfoById(this.config.layer_id_dc);\r\n        // lyr_dc_sys = this.layersMap.getLayerInfoById(this.config.layer_id_dc_sys);\r\n        lyr_dm = this.layersMap.getLayerInfoById(this.config.layer_id_dm);\r\n        lyr_dc.hide();\r\n        // lyr_dc_sys.hide();\r\n        lyr_dm.hide();\r\n        lyr_dc.setFilter(whereDefinition);\r\n        // lyr_dc_sys.setFilter(whereDefinition);\r\n        lyr_dm.setFilter(whereDefinition);\r\n        this.busyIndicator.hide()\r\n        this.container_resultados_opcion_cw.classList.remove('active');\r\n        this.ap_none_resultados_opcion_cw.hidden = false;\r\n        this.controller_layer_query = false;\r\n    },\r\n\r\n    onClose() {\r\n        console.log('Consulta_wgt::onClose');\r\n        if (this.controller_layer_query) {\r\n            this._showMessage(this.nls.clean_map_question, type = 'question')\r\n        }\r\n    },\r\n    // onMinimize(){\r\n    //   console.log('Consulta_wgt::onMinimize');\r\n    // },\r\n    // onMaximize(){\r\n    //   console.log('Consulta_wgt::onMaximize');\r\n    // },\r\n    // onSignIn(credential){\r\n    //   console.log('Consulta_wgt::onSignIn', credential);\r\n    // },\r\n    // onSignOut(){\r\n    //   console.log('Consulta_wgt::onSignOut');\r\n    // }\r\n    // onPositionChange(){\r\n    //   console.log('Consulta_wgt::onPositionChange');\r\n    // },\r\n    // resize(){\r\n    //   console.log('Consulta_wgt::resize');\r\n    // }\r\n\r\n    _queryDcGeneral() {\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        // var feature_dc = self_cw.layersMap.getLayerInfoById(self_cw.config.layer_id_dc);\r\n        self_cw.feature_dc.hide();\r\n        self_cw.feature_dc.setFilter('');\r\n        self_cw.feature_dc.getLayerObject().then(\r\n                function(response) {\r\n                    response.queryCount(query, function(results) {\r\n                        self_cw.numero_registros = results\r\n                        self_cw.ap_indicador_resultados_cw.innerText = results;\r\n                        self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n                        self_cw._generatePages();\r\n                        self_cw._queryDcByPage();\r\n                    }, function(error) {\r\n                        self_cw._showMessage(error.message, type = 'error')\r\n                    })\r\n                })\r\n            .catch((error) => {\r\n                self_cw._showMessage(error.message, type = 'error')\r\n                self_cw.busyIndicator_lw.hide();\r\n            });\r\n    },\r\n\r\n    queryDmGeneral() {\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        self_cw.feature_dm.hide();\r\n        self_cw.feature_dm.setFilter('');\r\n        self_cw.feature_dm.getLayerObject()\r\n            .then(\r\n                function(response) {\r\n                    response.queryIds(query, function(results) {\r\n                        // console.log(results);\r\n                        self_cw.numero_registros = results.length\r\n                        self_cw.ap_indicador_resultados_cw.innerText = results.length;\r\n                        self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n                        self_cw._generatePages();\r\n                        self_cw._queryDmByPage();\r\n                        // self_cw.busyIndicator.hide();\r\n                    }, function(error) {\r\n                        self_cw._showMessage(error.message, type = 'error')\r\n                    })\r\n                })\r\n            .catch((error) => {\r\n                self_cw._showMessage(error.message, type = 'error')\r\n                self_cw.busyIndicator_lw.hide();\r\n            });\r\n    },\r\n\r\n    _queryDcByPage(n = 1) {\r\n        // self_cw.feature_dc_sys.hide();\r\n        self_cw.busyIndicator.show();\r\n\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.busyIndicator.hide();\r\n            self_cw.ap_titulo_registros_resultados_cw.innerText = '';\r\n            self_cw.ap_resultados_cw.click();\r\n            return;\r\n        };\r\n\r\n        let query = new Query();\r\n        query.returnGeometry = false;\r\n        query.where = self_cw.whereDefinition;\r\n        query.num = self_cw.registros_pagina;\r\n        query.start = n == 1 ? 0 : (n - 1) * self_cw.registros_pagina;\r\n        query.orderByFields = [self_cw.field_id];\r\n\r\n        var start = query.start + 1\r\n        var fin = query.start + query.num > self_cw.numero_registros ? self_cw.numero_registros : self_cw.pagina_actual * query.num\r\n        self_cw.ap_titulo_registros_resultados_cw.innerText = String(start) + ' - ' + String(fin)\r\n\r\n        self_cw.feature_dc.hide();\r\n        self_cw.feature_dc.setFilter('');\r\n\r\n        // Realizando el query a la capa\r\n        self_cw.feature_dc.layerObject.queryFeatures(query, function(result) {\r\n            var rowcount = result.features.length;\r\n            if (rowcount) {\r\n                self_cw.controller_layer_query = true;\r\n            }\r\n            // self_cw.ap_indicador_resultados_cw.innerText = rowcount;\r\n            // self_cw.ap_titulo_resultados_cw.innerText = self_cw.titulo_consulta.innerText + ' encontrados';\r\n\r\n            var data = result.features.map((i) => i.attributes);\r\n\r\n            let ids = data.map((i) => i[self_cw.field_id])\r\n            let ids_join = ids.join(', ')\r\n            let query_ids = self_cw.field_id + ' IN (' + ids_join + ')'\r\n\r\n\r\n            self_cw.feature_dc.setFilter(query_ids);\r\n            self_cw.feature_dc.show();\r\n\r\n            // self_cw.feature_dc_sys.setFilter(query_ids);\r\n            // self_cw.feature_dc_sys.show();\r\n\r\n            self_cw._populateResultsDC(data, start)\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n        self_cw.feature_dc.layerObject.queryExtent(query, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        });\r\n\r\n        if (self_cw.numero_paginas <= 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n            return;\r\n        }\r\n\r\n        if (n == 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        } else if (n == self_cw.numero_paginas) {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n        } else {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        }\r\n\r\n    },\r\n\r\n    _queryDmByPage(n = 1) {\r\n        // self_cw.feature_dc_sys.hide();\r\n        self_cw.busyIndicator.show();\r\n\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.busyIndicator.hide();\r\n            self_cw.ap_titulo_registros_resultados_cw.innerText = '';\r\n            self_cw.ap_resultados_cw.click();\r\n            return;\r\n        };\r\n\r\n        let query = new Query();\r\n        query.where = self_cw.whereDefinition;\r\n        query.returnGeometry = false;\r\n        query.num = self_cw.registros_pagina;\r\n        query.start = n == 1 ? 0 : (n - 1) * self_cw.registros_pagina;\r\n        query.orderByFields = [self_cw.field_id_unidad];\r\n\r\n        var start = query.start + 1\r\n        var fin = query.start + query.num > self_cw.numero_registros ? self_cw.numero_registros : self_cw.pagina_actual * query.num\r\n        self_cw.ap_titulo_registros_resultados_cw.innerText = String(start) + ' - ' + String(fin)\r\n\r\n        self_cw.feature_dm.hide();\r\n        self_cw.feature_dm.setFilter('');\r\n\r\n        // Realizando el query a la capa\r\n        self_cw.feature_dm.layerObject.queryFeatures(query, function(result) {\r\n            let rowcount = result.features.length;\r\n            if (rowcount) {\r\n                self_cw.controller_layer_query = true;\r\n            }\r\n\r\n            let data = result.features.map((i) => i.attributes);\r\n\r\n            let ids = data.map((i) => i[self_cw.field_id_unidad])\r\n            let ids_join = ids.join(\"', '\")\r\n            let query_ids = self_cw.field_id_unidad + \" IN ('\" + ids_join + \"')\"\r\n\r\n\r\n            self_cw.feature_dm.setFilter(query_ids);\r\n            self_cw.feature_dm.show();\r\n\r\n            self_cw._populateResultsDM(data, start);\r\n\r\n            self_cw.ap_none_resultados_opcion_cw.hidden = true;\r\n            var class_list_container_resultados = self_cw.container_resultados_opcion_cw.classList;\r\n            if (!class_list_container_resultados.contains('active')) {\r\n                self_cw.container_resultados_opcion_cw.classList.toggle('active');\r\n            }\r\n            self_cw.ap_resultados_cw.click();\r\n            self_cw.busyIndicator.hide();\r\n        });\r\n\r\n        self_cw.feature_dm.layerObject.queryExtent(query, (results) => {\r\n            if (results.count) {\r\n                self_cw.map.setExtent(results.extent, true);\r\n            }\r\n        });\r\n\r\n        if (self_cw.numero_paginas <= 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n            return;\r\n        }\r\n\r\n        if (n == 1) {\r\n            self_cw.ap_anterior_page_cw.setAttribute('disabled', true)\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        } else if (n == self_cw.numero_paginas) {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.setAttribute('disabled', true)\r\n        } else {\r\n            self_cw.ap_anterior_page_cw.removeAttribute('disabled')\r\n            self_cw.ap_siguiente_page_cw.removeAttribute('disabled')\r\n        }\r\n    },\r\n\r\n    _queryDcByPageEvent(evt) {\r\n        // Obtiene el numero de la pagina\r\n        let page = evt.target.innerText;\r\n\r\n        self_cw.pagina_actual = parseInt(page);\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n\r\n        // Filtro de elementos\r\n        self_cw._queryDcByPage(self_cw.pagina_actual);\r\n\r\n        // Remover la pagina anterior seleccionada\r\n        dojo.query('.is-current').toggleClass('is-current');\r\n\r\n        // Activar la pagina actual seleccionada\r\n        evt.target.classList.toggle('is-current')\r\n    },\r\n\r\n    _queryDmByPageEvent(evt) {\r\n        // Obtiene el numero de la pagina\r\n        let page = evt.target.innerText;\r\n\r\n        self_cw.pagina_actual = parseInt(page);\r\n        self_cw.ap_registros_encontrados_cw.innerHTML = '';\r\n\r\n        // Filtro de elementos\r\n        self_cw._queryDmByPage(self_cw.pagina_actual);\r\n\r\n        // Remover la pagina anterior seleccionada\r\n        dojo.query('.is-current').toggleClass('is-current');\r\n\r\n        // Activar la pagina actual seleccionada\r\n        evt.target.classList.toggle('is-current')\r\n    },\r\n\r\n    _nextPage(evt) {\r\n        self_cw.pagina_actual = self_cw.pagina_actual == self_cw.numero_paginas ? self_cw.pagina_actual : self_cw.pagina_actual + 1;\r\n\r\n        if (!self_cw.grupos_paginas[self_cw.grupo_actual].includes(self_cw.pagina_actual)) {\r\n            self_cw.grupo_actual = self_cw.grupo_actual == self_cw.grupos_paginas.length - 1 ? self_cw.grupo_actual : self_cw.grupo_actual + 1;\r\n            self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual)\r\n        }\r\n        dojo.query(`#page_${self_cw.pagina_actual}_cw`)[0].click();\r\n    },\r\n\r\n    _backPage(evt) {\r\n        self_cw.pagina_actual = self_cw.pagina_actual == 1 ? self_cw.pagina_actual : self_cw.pagina_actual - 1;\r\n        if (!self_cw.grupos_paginas[self_cw.grupo_actual].includes(self_cw.pagina_actual)) {\r\n            self_cw.grupo_actual = self_cw.grupo_actual == 0 ? self_cw.grupo_actual : self_cw.grupo_actual - 1;\r\n            self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual)\r\n        }\r\n        dojo.query(`#page_${self_cw.pagina_actual}_cw`)[0].click();\r\n    },\r\n\r\n    _generatePages() {\r\n        if (self_cw.numero_registros == 0) {\r\n            self_cw.ap_pagination_cw.classList.remove('paginationActive');\r\n            self_cw.ap_pagination_list_cw.innerHTML = '';\r\n            self_cw.busyIndicator.hide();\r\n            return\r\n        }\r\n        if (!self_cw.ap_pagination_cw.classList.contains('paginationActive')) {\r\n            self_cw.ap_pagination_cw.classList.add('paginationActive');\r\n        }\r\n        self_cw.numero_paginas = Math.ceil(self_cw.numero_registros / self_cw.registros_pagina);\r\n        self_cw.grupos_paginas = self_cw._generateGroupsPages(self_cw.numero_paginas, self_cw.factor);\r\n        self_cw.grupo_actual = 0 // Es el primer grupo\r\n        self_cw.pagina_actual = 1 // Segundo parametro es 1 porque es la primera pagina\r\n\r\n        self_cw._generatePagesFromArray(self_cw.grupos_paginas[self_cw.grupo_actual], self_cw.pagina_actual);\r\n    },\r\n\r\n    _generateGroupsPages(numero_paginas, factor) {\r\n        let paginas = Array.from(Array(numero_paginas + 1).keys()).slice(1);\r\n        let grupos = Math.ceil(numero_paginas / factor);\r\n        var grupos_array = Array.from(Array(grupos).keys());\r\n        let grupos_paginas = grupos_array.map((i) => paginas.slice(i * factor, (i + 1) * factor));\r\n        return grupos_paginas;\r\n    },\r\n\r\n    _generatePagesFromArray(pages, val) {\r\n        let pages_html_array = [];\r\n        pages.forEach(function(n) {\r\n            let class_element = n == val ? 'pagination-link is-current pages_result_cw' : 'pagination-link pages_result_cw'\r\n            pages_html_array.push(`<li><a id=\"page_${n}_cw\" class=\"${class_element}\" aria-label=\"Pagina ${n}\">${n}</a></li>`)\r\n        });\r\n\r\n        if (self_cw.grupo_actual == 0 && self_cw.grupos_paginas.length == 1) {\r\n            // No hace nada\r\n        } else if (self_cw.grupo_actual == 0 && self_cw.grupos_paginas.length > 1) {\r\n            pages_html_array.push('<li><span class=\"pagination-ellipsis\">&hellip;</span></li>')\r\n        } else if (self_cw.grupo_actual == self_cw.grupos_paginas.length - 1) {\r\n            pages_html_array.splice(0, 0, '<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n        } else {\r\n            pages_html_array.push('<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n            pages_html_array.splice(0, 0, '<li><span class=\"pagination-ellipsis\">&hellip;</span></li>');\r\n        }\r\n\r\n        pages_html = pages_html_array.join('');\r\n        self_cw.ap_pagination_list_cw.innerHTML = pages_html;\r\n\r\n        if (self_cw.controller_query == 'dc') {\r\n            dojo.query('.pages_result_cw').on('click', self_cw._queryDcByPageEvent);\r\n        } else if (self_cw.controller_query == 'dm') {\r\n            dojo.query('.pages_result_cw').on('click', self_cw._queryDmByPageEvent);\r\n        }\r\n    },\r\n\r\n    _applyQueryDC2() {\r\n        self_cw.feature_dm.hide();\r\n        let whereDefinitionArray = [];\r\n        self_cw.whereDefinition = '';\r\n\r\n        let ruc_dc = `(${self_cw.field_m_ruc} is not null)`;\r\n\r\n        if (self_cw.input_ruc_dc_cw.value != '') {\r\n            ruc_dc = `(${self_cw.field_m_ruc} like '%${self_cw.input_ruc_dc_cw.value}%' and ${ruc_dc})`;\r\n        }\r\n\r\n        whereDefinitionArray.push(ruc_dc);\r\n\r\n        let nombre_dc = `(lower(${self_cw.field_minero_informal}) like lower('%${self_cw.input_nombre_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombre_dc);\r\n\r\n        if (self_cw.select_tipo_persona_cw.value != '') {\r\n            let tipo_persona_dc = `(${self_cw.field_tipo_persona} like '%${self_cw.select_tipo_persona_cw.value}%')`;\r\n            whereDefinitionArray.push(tipo_persona_dc);\r\n        };\r\n\r\n        let codigou_dc = `(upper(${self_cw.field_id_unidad}) like upper('%${self_cw.input_codigou_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dc);\r\n\r\n        let nombredm_dc = `(lower(${self_cw.field_derecho_minero}) like lower('%${self_cw.input_nombre_dm_dc_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dc);\r\n\r\n        let ubigeo_dc = `(${self_cw.field_id_ubigeo_inei} like '${self_cw.controller_ubigeo}%')`;\r\n        whereDefinitionArray.push(ubigeo_dc);\r\n\r\n        self_cw.whereDefinition = whereDefinitionArray.join(' and ');\r\n        self_cw._queryDcGeneral();\r\n    },\r\n\r\n    _applyQueryDM2() {\r\n        self_cw.feature_dc.hide();\r\n        let whereDefinitionArray = []\r\n        self_cw.whereDefinition = ''\r\n\r\n        var codigou_dm = `(upper(${self_cw.field_codigou_dm}) like upper('%${self_cw.input_codigou_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(codigou_dm)\r\n\r\n        var nombredm_dm = `(lower(${self_cw.field_concesion_dm}) like lower('%${self_cw.input_nombre_dm_cw.value}%'))`;\r\n        whereDefinitionArray.push(nombredm_dm)\r\n\r\n        self_cw.whereDefinition = whereDefinitionArray.join(' and ');\r\n\r\n        self_cw.queryDmGeneral();\r\n    },\r\n});"]}